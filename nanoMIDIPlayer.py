import os
import re
import io
import sys
import time
import json
import mido
import random
import base64
import ctypes
import datetime
import requests
import argparse
import platform
import threading
import webbrowser
import subprocess
import customtkinter
import tkinter as tk
import keyboard as kb
import concurrent.futures

from io import BytesIO
from queue import Queue
from mido import MidiFile
from threading import Event
from PIL import Image, ImageTk
from pynput.keyboard import Controller, Key, Listener
from tkinter import filedialog, Toplevel, LEFT, SOLID, Label

version = "9.69.69"
os_name = platform.system()

if os_name == "Darwin":
    import HIServices # type: ignore
    is_input_trusted = HIServices.AXIsProcessTrusted()
    base_directory = os.path.join(os.path.expanduser("~"), 'nanoMIDIPlayer')
else:
    base_directory = os.getcwd()

config_filename = 'config.json'
config_path = os.path.join(base_directory, config_filename)

theme_filename = 'activeTheme.json'
theme_path = os.path.join(f"{base_directory}/assets", config_filename)

LOGO = "iVBORw0KGgoAAAANSUhEUgAAAyAAAAMgCAYAAADbcAZoAAAAAXNSR0IArs4c6QAAIABJREFUeF7s3Qd8ZGW9//HfcybJsoBsSSaz7i64SlOaBSuCBbtYsACWq4gg2FC5Ajb03r8ogliQoi6KgoqAwBVs2FCRoigCUqxwBWGXTSZZdinKJpnz/Oc7d7KEJTNz5pyZJzPJ57xeea2YOe19njM53/M0ZywIIIAAAggggAACCCCAQCABF2g/7AYBBBBAAAEEEEAAAQQQMAIIhQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEEEEAAAQQQQAABAghlAAEEEEAAAQQQQAABBIIJEECCUbMjBBBAAAEEEEAAAQQQIIBQBhBAAAEEEEAAAQQQQCCYAAEkGDU7QgABBBBAAAEEEEAAAQIIZQABBBBAAAEEEEAAAQSCCRBAglGzIwQQQAABBBBAAAEEECCAUAYQQAABBBBAAAEEEEAgmAABJBg1O0IAAQQQQAABBBBAAAECCGUAAQQQQAABBBBAAAEEggkQQIJRsyMEEEAAAQQQQAABBBAggFAGEEAAAQQQQAABBBBAIJgAASQYNTtCAAEE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"

class LoadingScreen(tk.Tk):
    def __init__(self):
        if not os_name == "Darwin":
            super().__init__()
            self.overrideredirect(True)
            self.wm_attributes("-topmost", True)
            if os_name == "Darwin":
                self.wm_attributes("-transparent", True)
            else:
                self.wm_attributes("-transparentcolor", "black")

            screen_width = self.winfo_screenwidth()
            screen_height = self.winfo_screenheight()
            x = (screen_width // 2) - (256 // 2)
            y = (screen_height // 2) - (256 // 2)
            self.geometry(f"+{x}+{y}")

            self.showLogo()

            self.after(3000, self.loadMainApp)
        else:
            os.makedirs(base_directory, exist_ok=True)
            if not os.path.exists(config_path):
                self.loadConfig()
            else:
                self.checkConfig()

            with open(config_path, 'r') as config_file:
                config_data = json.load(config_file)

            if config_data["forceTheme"] or not os.path.exists(theme_path):
                self.loadTheme()

            app = App()
            app.mainloop()

    def showLogo(self):
        image_data = base64.b64decode(LOGO)
        image = Image.open(BytesIO(image_data)).convert("RGBA")
        image = image.resize((256, 256), Image.LANCZOS)

        self.photo = ImageTk.PhotoImage(image)
        self.label = tk.Label(self, image=self.photo, bg="black")
        self.label.pack()

        if not os.path.exists(config_path):
            self.loadConfig()
        else:
            self.checkConfig()

        with open(config_path, 'r') as config_file:
            config_data = json.load(config_file)

        if config_data["forceTheme"] or not os.path.exists(theme_path):
            self.loadTheme()

    def checkConfig(self):
        url = "https://raw.githubusercontent.com/NotHammer043/nanoMIDIPlayer/main/config.json"
        response = requests.get(url)
        if response.status_code == 200:
            remote_config = response.json()
        else:
            print("Failed to retrieve remote configuration.")
            remote_config = {}

        if os.path.exists(config_path):
            with open(config_path, 'r') as f:
                local_config = json.load(f)
        else:
            local_config = {}

        updated = False
        for key, value in remote_config.items():
            if key not in local_config:
                local_config[key] = value
                updated = True

        if updated:
            with open(config_path, 'w') as f:
                json.dump(local_config, f, indent=4)
            print("Updated Config")
        else:
            print("Config Up to Date")

    def loadConfig(self):
        original_config = "https://raw.githubusercontent.com/NotHammer043/nanoMIDIPlayer/main/config.json"

        response = requests.get(original_config)
        config = response.json()
        if response.status_code == 200:
            with open(config_path, 'w') as config_file:
                json.dump(config, config_file, indent=4)
            print("Downloaded Config")

    def loadTheme(self):
        response = requests.get("https://api.nanomidi.net/api/nanomidiplayer/theme")

        if response.status_code == 200:
            theme_data = response.json()
            os.makedirs(f"{base_directory}/assets", exist_ok=True)

            default_theme = theme_data.get("defaultTheme")
            available_themes = theme_data.get("availableThemes", {})

            default_theme_url = available_themes.get(str(default_theme))
            if default_theme_url:
                theme_response = requests.get(default_theme_url)
                if theme_response.status_code == 200:
                    with open(theme_path, "w") as file:
                        json.dump(theme_response.json(), file, indent=4)
                    print("Downloaded Theme")

    def loadMainApp(self):
        self.destroy()
        app = App()
        app.mainloop()

class ToolTip(object):
    def __init__(self, widget):
        with open(theme_path, 'r') as theme_file:
            self.activeThemeData = json.load(theme_file)

        if os_name == 'Windows':
            self.font = customtkinter.CTkFont(size=14, weight="normal", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
        elif os_name == 'Darwin':
            self.font = customtkinter.CTkFont(size=14, weight="normal", family=self.activeThemeData["Theme"]["GlobalFont"]["macOS"])
        elif os_name == 'Linux':
            self.font = customtkinter.CTkFont(size=14, weight="normal", family=self.activeThemeData["Theme"]["GlobalFont"]["Linux"])
        else:
            self.font = customtkinter.CTkFont(size=14, weight="normal", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])

        self.widget = widget
        self.tipwindow = None
        self.id = None
        self.x = self.y = 0

    def showtip(self, text):
        with open(config_path, 'r') as config_file:
            self.config_data = json.load(config_file)
        if self.config_data["tooltip"]:
            self.text = text
            if self.tipwindow or not self.text:
                return
            x, y, cx, cy = self.widget.bbox("insert")
            x = x + self.widget.winfo_rootx() + 57
            y = y + cy + self.widget.winfo_rooty() +27
            self.tipwindow = tw = Toplevel(self.widget)
            tw.wm_overrideredirect(1)
            tw.wm_attributes("-topmost", True)
            tw.wm_geometry("+%d+%d" % (x, y))
            label = Label(tw, text=self.text, justify=LEFT,
                        background="#ffffe0", relief=SOLID, borderwidth=1,
                        font=self.font)
            label.pack(ipadx=1)

    def hidetip(self):
        tw = self.tipwindow
        self.tipwindow = None
        if tw:
            tw.destroy()

class App(customtkinter.CTk):
    def __init__(self):
        
        with open(config_path, 'r') as config_file:
            self.config_data = json.load(config_file)
        with open(theme_path, 'r') as theme_file:
            self.activeThemeData = json.load(theme_file)

        def b64toimage(b64string):
            data = base64.b64decode(b64string)
            return Image.open(io.BytesIO(data))

        self.playback_state = False
        self.playback_start_time = None
        self.last_update_time = None
        self.max_log_messages = 4
        self.isRunning = False
        self.log_labels = []
        self.sustainToggle = False
        self.CloseThread = False
        self.pause_event = Event()
        self.pause_event.set()
        self.paused = False
        self.selected_device = None
        self.midi_file_path = None
        self.hasUpdated = False
        self.playback_speed = 100
        self.ignore_key_press = False
        self.output_devices = mido.get_output_names()
        self.keyboard_controller = Controller()
        self.keyboard_queue = Queue()
        self.pressed_keys = set()
        self.themeNames = self.fetchThemes()

        self.hotkeys = {
            'play': self.config_data['playHotkey'],
            'pause': self.config_data['pauseHotkey'],
            'stop': self.config_data['stopHotkey'],
            'speed': self.config_data['speedHotkey'],
            'slow': self.config_data['slowHotkey']
        }

        self.special_key_map = {
            # LISTENER > PYNPUT
            'ENTER': 'RETURN',
            'CTRL_L': 'CONTROL_L',
            'CTRL_R': 'CONTROL_R',
            'PRIOR': 'PAGE_UP',
            'NEXT': 'PAGE_DOWN',
            'SHIFT': 'SHIFT_L',
            'SHIFT_R': 'SHIFT_R',
            '<96>': '0',
            '<97>': '1',
            '<98>': '2',
            '<99>': '3',
            '<100>': '4',
            '<101>': '5',
            '<102>': '6',
            '<103>': '7',
            '<104>': '8',
            '<105>': '9',
            '<110>': 'PERIOD',
            'BRACKETRIGHT': ']',
            'BRACKETLEFT': '[',
            'APOSTROPHE': '\'',
            'BACKSLASH': '\\',
            'MINUS': '-',
            'EQUAL': '=',
            'COMMA': ',',
            'PERIOD': '.',
            'SLASH': '/',
            'ALT_R': 'ALT_GR',
            'SEMICOLON': ';',
        }

        self.listener = None
        threading.Thread(target=self.start_listener).start()

        parser = argparse.ArgumentParser(description='nanoMIDIPlayer')
        parser.add_argument('--debug', action='store_true', help='debug console')
        args = parser.parse_args()

        if args.debug:
            self.create_debug_console()
            print("console opened.")

        super().__init__()

        if os_name == 'Windows':
            self.global_font = customtkinter.CTkFont(size=14, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font11 = customtkinter.CTkFont(size=11, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font12 = customtkinter.CTkFont(size=12, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font20 = customtkinter.CTkFont(size=20, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font40 = customtkinter.CTkFont(size=40, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
        elif os_name == 'Darwin':
            self.global_font = customtkinter.CTkFont(size=14, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["macOS"])
            self.global_font11 = customtkinter.CTkFont(size=11, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["macOS"])
            self.global_font12 = customtkinter.CTkFont(size=12, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["macOS"])
            self.global_font20 = customtkinter.CTkFont(size=20, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["macOS"])
            self.global_font40 = customtkinter.CTkFont(size=40, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["macOS"])
        elif os_name == 'Linux':
            self.global_font = customtkinter.CTkFont(size=14, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Linux"])
            self.global_font11 = customtkinter.CTkFont(size=11, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Linux"])
            self.global_font12 = customtkinter.CTkFont(size=12, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Linux"])
            self.global_font20 = customtkinter.CTkFont(size=20, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Linux"])
            self.global_font40 = customtkinter.CTkFont(size=40, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Linux"])
        else:
            self.global_font = customtkinter.CTkFont(size=14, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font11 = customtkinter.CTkFont(size=11, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font12 = customtkinter.CTkFont(size=12, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font20 = customtkinter.CTkFont(size=20, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])
            self.global_font40 = customtkinter.CTkFont(size=40, weight="bold", family=self.activeThemeData["Theme"]["GlobalFont"]["Windows"])

        self.title("nanoMIDIPlayer")
        self.geometry("600x450")
        self.resizable(False, False)

        self.topmost_var = tk.BooleanVar()
        self.topmost_var.set(False)

        icon_image = b64toimage(self.activeThemeData["Theme"]["Icons"]["icon"])
        bannerimage = b64toimage(self.activeThemeData["Theme"]["Icons"]["banner"])
        resetimage = b64toimage(self.activeThemeData["Theme"]["Icons"]["reset"])
        pianoimage = b64toimage(self.activeThemeData["Theme"]["Icons"]["piano"])
        downloadimage = b64toimage(self.activeThemeData["Theme"]["Icons"]["download"])
        searchimage = b64toimage(self.activeThemeData["Theme"]["Icons"]["search"])
        settings_image = b64toimage(self.activeThemeData["Theme"]["Icons"]["cogwheel"])
        padlock_image = b64toimage(self.activeThemeData["Theme"]["Icons"]["padlock"])
        accessibility_image = b64toimage(self.activeThemeData["Theme"]["Icons"]["accessibilityimg"])
        inputmonitor_image = b64toimage(self.activeThemeData["Theme"]["Icons"]["inputmonitorimg"])

        self.logo_image = customtkinter.CTkImage(bannerimage, size=(86, 26))
        self.reset_image = customtkinter.CTkImage(resetimage, size=(16, 16))
        self.pianoimage = customtkinter.CTkImage(pianoimage, size=(20, 20))
        self.downloadimagefile = customtkinter.CTkImage(downloadimage, size=(18, 18))
        self.searchimagefile = customtkinter.CTkImage(searchimage, size=(18, 18))
        self.settingsimage = customtkinter.CTkImage(settings_image, size=(18, 18))
        self.padlockimage = customtkinter.CTkImage(padlock_image, size=(18, 18))
        self.accessibilityimage = customtkinter.CTkImage(accessibility_image, size=(349, 87))
        self.inputmonitorimage = customtkinter.CTkImage(inputmonitor_image, size=(349, 87))

        icon_path = os.path.join(os.path.dirname(__file__), "temp_icon.ico")
        icon_image.save(icon_path)

        self.iconbitmap(icon_path)

        self.grid_rowconfigure(0, weight=1)
        self.grid_columnconfigure(1, weight=1)

        self.navigation_frame = customtkinter.CTkFrame(self, corner_radius=0, fg_color=self.activeThemeData["Theme"]["Navigation"]["BackColor"])
        self.navigation_frame.grid(row=0, column=0, sticky="nsew")
        self.navigation_frame.grid_rowconfigure(5, weight=1)

        self.navigation_frame_label = customtkinter.CTkLabel(
            self.navigation_frame, text="", image=self.logo_image,
            compound="left", font=self.global_font20
        )
        self.navigation_frame_label.grid(row=0, column=0, padx=20, pady=20)

        self.home_button = customtkinter.CTkButton(
            self.navigation_frame, corner_radius=0, height=40, border_spacing=10, text="MIDI Player",
            fg_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonColor"], text_color=self.activeThemeData["Theme"]["Navigation"]["TextColor"], hover_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonHoverColor"],
            image=self.pianoimage, anchor="w", font=self.global_font, command=self.home_button_event
        )
        self.home_button.grid(row=1, column=0, sticky="ew")

        self.midi_hub = customtkinter.CTkButton(
            self.navigation_frame, corner_radius=0, height=40, border_spacing=10, text="MIDI Hub",
            fg_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonColor"], text_color=self.activeThemeData["Theme"]["Navigation"]["TextColor"], hover_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonHoverColor"],
            image=self.pianoimage, anchor="w", font=self.global_font, command=self.midi_hub_event
        )
        self.midi_hub.grid(row=2, column=0, sticky="ew")

        self.settings_tab = customtkinter.CTkButton(
            self.navigation_frame, corner_radius=0, height=40, border_spacing=10, text="Settings",
            fg_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonColor"], text_color=self.activeThemeData["Theme"]["Navigation"]["TextColor"], hover_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonHoverColor"],
            image=self.settingsimage, anchor="w", font=self.global_font, command=self.settings_tab_event
        )
        self.settings_tab.grid(row=4, column=0, sticky="ew")

        def checkForUpdates():
            try:
                response = requests.get("https://raw.githubusercontent.com/NotHammer043/nanoMIDIPlayer/main/version")
                response.raise_for_status()
                version_info = response.json()

                latest_versions = version_info.get("latest", [])
                avoid_versions = version_info.get("avoid", [])
                alert_message = version_info.get("alertMessage", "")

                if version in avoid_versions:
                    return "urgent", alert_message
                elif version not in latest_versions:
                    return "update", ""
            except requests.RequestException:
                print(f"Error checking for updates")

            return "none", ""

        update_status, urgent_message = checkForUpdates()

        def redirectUpdate():
            webbrowser.open("https://github.com/NotHammer043/nanoMIDIPlayer/releases/latest")

        def downloadBootstrapper():
            URL = "https://github.com/NotHammer043/nanoMIDIPlayer/raw/main/dist/bootstrapper.exe"
            FOLDER_PATH = "assets"
            FILE_PATH = os.path.join(FOLDER_PATH, "bootstrapper.exe")

            notification = customtkinter.CTkButton(
                self.home_frame, text=f"Downloading Bootstrapper...\nIf theres issue downloading try\ndisabling your antivirus.", fg_color="#006400", hover_color="#023020", command=destroyMessage, font=self.global_font
            )
            notification.grid(row=0, column=0, padx=(0,0), pady=(10,0), sticky="ns")
            notification._text_label.configure(wraplength=300)

            def download(url, file_path):
                response = requests.get(url, stream=True)
                response.raise_for_status()

                with open(file_path, 'wb') as file:
                    for chunk in response.iter_content(chunk_size=8192):
                        file.write(chunk)


            os.makedirs(FOLDER_PATH, exist_ok=True)

            download(URL, FILE_PATH)
            print(f"Downloaded {FILE_PATH}")

            subprocess.Popen(FILE_PATH, creationflags=subprocess.CREATE_NEW_CONSOLE)
            os._exit(1)

        def downloadBootstrapperThreaded():
            threading.Thread(target=downloadBootstrapper,).start()

        if update_status == "update":
            self.updateAvailable = customtkinter.CTkButton(
                self.navigation_frame, text="Update Available", fg_color="#006900", hover_color="#003200", command=redirectUpdate, font=self.global_font
            )
            self.updateAvailable.grid(row=6, column=0, padx=(0,0), pady=(0,5), sticky="n")

            if not os_name == "Darwin":
                self.updateNow = customtkinter.CTkButton(
                    self.navigation_frame, text="Update Now", fg_color="#FF8C00", hover_color="#8B4000", command=downloadBootstrapperThreaded, font=self.global_font
                )
                self.updateNow.grid(row=7, column=0, padx=(0,0), pady=(0,5), sticky="n")

        if os_name == "Darwin":
            self.macWarn = customtkinter.CTkLabel(
                self.navigation_frame, text="MACOS IS NOT\nFULLY TESTED!\nREPORT ANY BUGS", fg_color="transparent", text_color="#191919",
                font=self.global_font
            )
            self.macWarn.grid(row=5, column=0, padx=0, pady=(10, 0), sticky="n")

        self.themeCustomWatermarkLN1 = customtkinter.CTkLabel(
            self.navigation_frame, text=self.activeThemeData["Theme"]["Navigation"]["CustomThemeWatermarkLN1"], fg_color="transparent", text_color=self.activeThemeData["Theme"]["Navigation"]["CustomWatermarkColor"], font=self.global_font
        )
        self.themeCustomWatermarkLN1.grid(row=6, column=0, padx=0, pady=(0, 0), sticky="n")

        self.themeCustomWatermarkLN2 = customtkinter.CTkLabel(
            self.navigation_frame, text=self.activeThemeData["Theme"]["Navigation"]["CustomThemeWatermarkLN2"], fg_color="transparent", text_color=self.activeThemeData["Theme"]["Navigation"]["CustomWatermarkColor"], font=self.global_font
        )
        self.themeCustomWatermarkLN2.grid(row=7, column=0, padx=0, pady=(0, 0), sticky="n")

        self.appName = customtkinter.CTkLabel(
            self.navigation_frame, text=" >> nanoMIDIPlayer << ", fg_color="transparent", text_color=self.activeThemeData["Theme"]["Navigation"]["WatermarkColor"], font=self.global_font
        )
        self.appName.grid(row=8, column=0, padx=0, pady=(0, 0), sticky="n")

        self.versionlabel = customtkinter.CTkLabel(
            self.navigation_frame, text=f"version {version}", fg_color="transparent", text_color=self.activeThemeData["Theme"]["Navigation"]["WatermarkColor"], font=self.global_font
        )
        self.versionlabel.grid(row=9, column=0, padx=0, pady=(0, 0), sticky="s")

        # CONFIG

        def switchUseMIDI():
            self.config_data['useMIDI'] = switchUseMIDIvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)
            self.stop_playback()
            self.stop_playback_flag.set()
            self.useMIDIStatus()
            if switchUseMIDIvar.get() == "on":
                threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"-------< WARNING >-------",)).start()
                threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"This will not press keys",)).start()
                threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"for you, it will simulate",)).start()
                threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"MIDI Data!",)).start()
            else:
                for widget in self.consolekl.winfo_children():
                    widget.destroy()
                threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"Macro Mode.",)).start()

        def switchSustain():
            self.config_data['sustainEnabled'] = switchSustainvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchNoDoubles():
            self.config_data['noDoubles'] = switchNoDoublesvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchVelocity():
            self.config_data['velocity'] = switchVelocityvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switch88Keys():
            self.config_data['88Keys'] = switch88Keysvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchRandomFail():
            self.config_data['randomFail'] = switchRandomFailvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchLoopSong():
            self.config_data['loopSong'] = switchLoopSongvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchTooltip():
            self.config_data['tooltip'] = switchTooltipvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchForceTheme():
            self.config_data['forceTheme'] = switchForceThemevar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

        def switchConsole():
            self.config_data['console'] = switchConsolevar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)
            for widget in self.consolekl.winfo_children():
                    widget.destroy()
            if self.config_data['console']:
                threading.Thread(target=self.consolekl_text_insert, args=(f"If playback is laggy",)).start()
                threading.Thread(target=self.consolekl_text_insert, args=(f"Consider disabling this :)",)).start()
            else:
                threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"Disabled",)).start()

        def switchTopmost():
            self.config_data['topMost'] = switchTopmostvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

            if self.config_data['topMost']:
                self.attributes('-topmost', True)
            else:
                self.attributes('-topmost', False)

        def switchTimestamp():
            self.config_data['timestamp'] = switchTimestampvar.get() == "on"
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

            if not self.config_data.get('midiFile') == "":
                midifile = MidiFile(self.config_data.get('midiFile'))
                self.total_time = midifile.length
                self.timelineTextLoadMIDI = f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}" if self.config_data['timestamp'] else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
                self.timeline.configure(text=self.timelineTextLoadMIDI)
            else:
                self.timelineTextLoadMIDI = f"0:00:00 / 0:00:00" if self.config_data['timestamp'] else f"X:XX:XX / 0:00:00"
                self.timeline.configure(text=self.timelineTextLoadMIDI)

        switchUseMIDIvar = customtkinter.StringVar(value="off")
        switchSustainvar = customtkinter.StringVar(value="off")
        switchNoDoublesvar = customtkinter.StringVar(value="off")
        switchVelocityvar = customtkinter.StringVar(value="off")
        switch88Keysvar = customtkinter.StringVar(value="off")
        switchConsolevar = customtkinter.StringVar(value="off")
        switchTopmostvar = customtkinter.StringVar(value="off")
        switchTimestampvar = customtkinter.StringVar(value="off")
        switchRandomFailvar = customtkinter.StringVar(value="off")
        switchLoopSongvar = customtkinter.StringVar(value="off")
        switchTooltipvar = customtkinter.StringVar(value="off")
        switchForceThemevar = customtkinter.StringVar(value="off")

        self.midi_port_lock = threading.Lock()

        switchUseMIDIvar.set("on" if self.config_data.get('useMIDI', False) else "off")
        switchSustainvar.set("on" if self.config_data.get('sustainEnabled', False) else "off")
        switchNoDoublesvar.set("on" if self.config_data.get('noDoubles', False) else "off")
        switchVelocityvar.set("on" if self.config_data.get('velocity', False) else "off")
        switch88Keysvar.set("on" if self.config_data.get('88Keys', False) else "off")
        switchConsolevar.set("on" if self.config_data.get('console', False) else "off")
        switchTopmostvar.set("on" if self.config_data.get('topMost', False) else "off")
        switchTimestampvar.set("on" if self.config_data.get('timestamp', False) else "off")
        switchRandomFailvar.set("on" if self.config_data.get('randomFail', False) else "off")
        switchLoopSongvar.set("on" if self.config_data.get('loopSong', False) else "off")
        switchTooltipvar.set("on" if self.config_data.get('tooltip', False) else "off")
        switchForceThemevar.set("on" if self.config_data.get('forceTheme', False) else "off")

        # MIDI
        self.home_frame = customtkinter.CTkFrame(self.master, corner_radius=0, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["BackgroundColor"])
        self.home_frame.grid_columnconfigure(0, weight=1)

        self.home_frame_label_1 = customtkinter.CTkLabel(
            self.home_frame, text="MIDI Output Device", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1.grid(row=0, column=0, padx=(0, 200), pady=(10, 0), sticky="s")

        self.home_frame_label_1_toggle = customtkinter.CTkSwitch(
            self.home_frame, text="Use MIDI", command=switchUseMIDI, variable=switchUseMIDIvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1_toggle.grid(row=0, column=0, padx=(0, 40), pady=(10, 0), sticky="e")

        self.CreateToolTip(self.home_frame_label_1_toggle, text = 'Simulates MIDI signals and sends them\nto the selected MIDI Output\n\nNOTE: Having this enabled won\'t simulate\nQWERTY Keys for you if you\'re looking to macro.')

        loopbe_device = next((device for device in self.output_devices if "LoopBe" in device), None)

        self.home_frame_combobox_1 = customtkinter.CTkOptionMenu(
            self.home_frame, width=350, values=self.output_devices, font=self.global_font, dropdown_font=self.global_font, command=self.stop_playback, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionBackColor"], dropdown_fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionDropdownBackground"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionDropdownButtonColor"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionDropdownButtonHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )

        if not self.output_devices:
            self.output_devices = ["No output devices available"]

        default_device = loopbe_device if loopbe_device else self.output_devices[0]
        self.home_frame_combobox_1.set(default_device)

        self.home_frame_combobox_1.grid(row=1, column=0, padx=0, pady=0)

        self.home_frame_label_2 = customtkinter.CTkLabel(
            self.home_frame, text="MIDI File Path", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_2.grid(row=2, column=0, padx=(0,200), pady=(10, 0))

        def switchMIDIEvent(event=None):
            self.ignore_key_press = False
            self.config_data["midiFile"] = self.home_frame_entry_1.get()
            with open(config_path, 'w') as file:
                json.dump(self.config_data, file, indent=2)

        self.home_frame_entry_1 = customtkinter.CTkOptionMenu(self.home_frame, width=350, values="", command=switchMIDIEvent, font=self.global_font, dropdown_font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionBackColor"], dropdown_fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionDropdownBackground"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionDropdownButtonColor"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["OptionDropdownButtonHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"])
        self.home_frame_entry_1.grid(row=3, column=0, padx=20, pady=(10, 0))

        self.select_file_button = customtkinter.CTkButton(
            self.home_frame, text="Select File", command=self.open_file_dialog, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["ButtonHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.select_file_button.grid(row=2, column=0, padx=(0,55), pady=(10,0), sticky="e")

        self.consolekl = tk.Frame(master=self.home_frame, width=200, height=90, bg=self.activeThemeData["Theme"]["MidiPlayer"]["ConsoleBackground"])
        self.consolekl.grid(row=4, column=0, padx=(0,40), pady=(35,0), sticky="ne")
        self.consolekl.pack_propagate(0)

        self.home_frame_label_3 = customtkinter.CTkLabel(
            self.home_frame, text=" Play:", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_3.grid(row=5, column=0, padx=(0, 300), pady=(0, 60), sticky="s")

        self.play_hotkey = customtkinter.CTkButton(
            self.home_frame, text=self.config_data.get('playHotkey', 'F1'), width=70, command=self.getPlayHotkey, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.play_hotkey.grid(row=5, column=0, padx=(0, 165), pady=(0, 60), sticky="s")

        self.home_frame_label_4 = customtkinter.CTkLabel(
            self.home_frame, text="Pause:", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_4.grid(row=5, column=0, padx=(0, 300), pady=(0, 30), sticky="s")

        self.pause_hotkey = customtkinter.CTkButton(
            self.home_frame, text=self.config_data.get('pauseHotkey', 'F2'), width=70, command=self.getPauseHotkey, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.pause_hotkey.grid(row=5, column=0, padx=(0, 165), pady=(0, 30), sticky="s")

        self.home_frame_label_5 = customtkinter.CTkLabel(
            self.home_frame, text=" Stop:", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_5.grid(row=5, column=0, padx=(0, 300), pady=(0, 0), sticky="s")

        self.stop_hotkey = customtkinter.CTkButton(
            self.home_frame, text=self.config_data.get('stopHotkey', 'F3'), width=70, command=self.getStopHotkey, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.stop_hotkey.grid(row=5, column=0, padx=(0, 165), pady=(0, 0), sticky="s")

        self.home_frame_label_6 = customtkinter.CTkLabel(
            self.home_frame, text="Slow Down:", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_6.grid(row=5, column=0, padx=(80, 0), pady=(0, 60), sticky="s")

        self.speed_hotkey = customtkinter.CTkButton(
            self.home_frame, text=self.config_data.get('speedHotkey', 'F4'), width=70, command=self.getSpeedUpHotkey, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.speed_hotkey.grid(row=5, column=0, padx=(250, 0), pady=(0, 60), sticky="s")

        self.home_frame_label_7 = customtkinter.CTkLabel(
            self.home_frame, text=" Speed Up:", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_7.grid(row=5, column=0, padx=(80, 0), pady=(0, 30), sticky="s")

        self.slow_hotkey = customtkinter.CTkButton(
            self.home_frame, text=self.config_data.get('slowHotkey', 'F5'), width=70, command=self.getSlowDownHotkey, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["HotkeySelectorHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.slow_hotkey.grid(row=5, column=0, padx=(250, 0), pady=(0, 30), sticky="s")

        self.home_frame_label_1_toggle_console = customtkinter.CTkSwitch(
            self.home_frame, text="Console", command=switchConsole, variable=switchConsolevar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1_toggle_console.grid(row=4, column=0, padx=(184, 0), pady=(10, 10), sticky="nw")

        self.CreateToolTip(self.home_frame_label_1_toggle_console, text = 'Displays the notes playing\n(Can cause slight lag while playing)')

        self.home_frame_label_1_toggle_sustain = customtkinter.CTkSwitch(
            self.home_frame, text="Sustain   ", command=switchSustain, variable=switchSustainvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1_toggle_sustain.grid(row=4, column=0, padx=(40, 0), pady=(10, 0), sticky="nw")

        self.CreateToolTip(self.home_frame_label_1_toggle_sustain, text = 'Simulates Pedal by "Spacebar"\nOnly works on supported games.')

        self.home_frame_label_1_toggle_nodoubles = customtkinter.CTkSwitch(
            self.home_frame, text="No Doubles", command=switchNoDoubles, variable=switchNoDoublesvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1_toggle_nodoubles.grid(row=4, column=0, padx=(40, 0), pady=(40, 0), sticky="nw")

        self.CreateToolTip(self.home_frame_label_1_toggle_nodoubles, text = 'Prevents double-triggering of keys')

        self.home_frame_label_1_toggle_velocity = customtkinter.CTkSwitch(
            self.home_frame, text="Velocity  ", command=switchVelocity, variable=switchVelocityvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1_toggle_velocity.grid(row=4, column=0, padx=(40, 0), pady=(70, 0), sticky="nw")

        self.CreateToolTip(self.home_frame_label_1_toggle_velocity, text = 'Simulates how hard a key is pressed by "CTRL"\nwhich affects the loudness of that note\nOnly works on supported')

        self.home_frame_label_1_toggle_88keys = customtkinter.CTkSwitch(
            self.home_frame, text="88 Keys   ", command=switch88Keys, variable=switch88Keysvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.home_frame_label_1_toggle_88keys.grid(row=4, column=0, padx=(40, 0), pady=(100, 10), sticky="nw")

        self.CreateToolTip(self.home_frame_label_1_toggle_88keys, text = 'Process MIDI notes according to the 88-key mapping.')

        self.play_button = customtkinter.CTkButton(
            self.home_frame, text="Play", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColor"], width=80, command=self.playButtonCommand, font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColorHover"]
        )
        self.play_button.grid(row=10, column=0, padx=45, pady=(0, 0), sticky="w")

        self.reset_button = customtkinter.CTkButton(
            self.home_frame, text="Stop",fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorDisabled"], width=80, state="disabled", command=self.stop_playback, font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorHover"]
        )
        self.reset_button.grid(row=10, column=0, padx=130, pady=(0, 0), sticky="w")

        self.timelineText = "0:00:00 / 0:00:00" if self.config_data['timestamp'] else "X:XX:XX / 0:00:00"

        self.timeline = customtkinter.CTkLabel(
            self.home_frame, text=self.timelineText, fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.timeline.grid(row=10, column=0, padx=(0, 50), pady=(0, 0), sticky="e")

        self.speedlabel = customtkinter.CTkLabel(
            self.home_frame, text="Speed", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.speedlabel.grid(row=9, column=0, padx=(0,290), pady=(15, 0))

        self.speed = customtkinter.CTkSlider(self.home_frame, from_=50, to=500, command=self.sliderupdate, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SpeedSliderBackColor"], progress_color=self.activeThemeData["Theme"]["MidiPlayer"]["SpeedSliderFillColor"], button_color=self.activeThemeData["Theme"]["MidiPlayer"]["SpeedSliderCircleColor"], button_hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["SpeedSliderCircleHoverColor"])
        self.speed.grid(row=9, column=0, padx=(0,50), pady=(15, 0))
        self.speed.set(100)

        self.CreateToolTip(self.speed, text = 'Playback Speed')

        self.resetspeed = customtkinter.CTkButton(
            self.home_frame, image=self.reset_image, text="", width=30, command=self.resetspeedvalue, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["ButtonHoverColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["MidiPlayer"]["TextColorDisabled"]
        )
        self.resetspeed.grid(row=9, column=0, padx=(290, 0), pady=(15, 0))

        self.speedtext = customtkinter.CTkEntry(
            self.home_frame, placeholder_text="100", width=50, fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["SpeedValueBoxBackColor"], font=self.global_font, border_color=self.activeThemeData["Theme"]["MidiPlayer"]["SpeedValueBoxBorderColor"], text_color=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"]
        )
        self.speedtext.grid(row=9, column=0, padx=(200,0), pady=(15, 0))
        self.speedtext.insert(0, "100")

        self.speedtext.bind("<FocusOut>", self.slidertoentry)
        self.speedtext.bind("<KeyRelease>", self.slidertoentry)
        self.speed.bind("<ButtonRelease-1>", self.entrytoslider)

        self.stop_playback_flag = threading.Event()

        # SETTINGS

        self.settings_tab_frame = customtkinter.CTkScrollableFrame(self.master, corner_radius=0, fg_color=self.activeThemeData["Theme"]["Settings"]["BackgroundColor"])

        self.settings_tab_frame_label_performance = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Performance", fg_color="transparent", font=self.global_font20, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_performance.grid(row=0, column=0, padx=(10, 0), pady=(15, 0), sticky="w")

        self.settings_tab_frame_label_toggle_timestamp = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Timestamp", command=switchTimestamp, variable=switchTimestampvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_timestamp.grid(row=1, column=0, padx=(20, 0), pady=(30, 0), sticky="nw")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_timestamp, text = 'Toggles timestamp updates')

        self.settings_tab_frame_open_ex_con = customtkinter.CTkButton(
            self.settings_tab_frame, text="Open Debug\nConsole", width=120, command=self.create_debug_console, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["ButtonHoverColor"]
        )
        self.settings_tab_frame_open_ex_con.grid(row=0, column=0, padx=(150, 0), pady=(14, 0), sticky="w")

        self.CreateToolTip(self.settings_tab_frame_open_ex_con, text = 'Opens up a CMD window with logs')

        self.settings_tab_frame_close_ex_con = customtkinter.CTkButton(
            self.settings_tab_frame, text="Close Debug\nConsole", width=120, command=self.close_debug_console, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["ButtonHoverColor"]
        )
        self.settings_tab_frame_close_ex_con.grid(row=0, column=0, padx=(280, 0), pady=(14, 0), sticky="w")

        self.CreateToolTip(self.settings_tab_frame_close_ex_con, text = 'Closes CMD Window')

        if os_name != 'Windows':
            self.settings_tab_frame_open_ex_con.configure(state='disabled')
            self.settings_tab_frame_close_ex_con.configure(state='disabled')

        self.settings_tab_frame_label_toggle_topmost = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Topmost", command=switchTopmost, variable=switchTopmostvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_topmost.grid(row=1, column=0, padx=(155, 0), pady=(30, 0), sticky="nw")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_topmost, text = 'Stays on top even if you don\'t focus on the app.')

        self.settings_tab_frame_label_toggle_decreaselabel = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Decrease Size", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_toggle_decreaselabel.grid(row=1, column=0, padx=(85,0), pady=(9, 0), sticky="n")

        self.settings_tab_frame_label_toggle_changedecrease = customtkinter.CTkSlider(self.settings_tab_frame, from_=1, to=100, width=125, command=self.sliderupdate_decreaseSize, fg_color=self.activeThemeData["Theme"]["Settings"]["SliderBackColor"], progress_color=self.activeThemeData["Theme"]["Settings"]["SliderFillColor"], button_color=self.activeThemeData["Theme"]["Settings"]["SliderCircleColor"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SliderCircleHoverColor"])
        self.settings_tab_frame_label_toggle_changedecrease.grid(row=2, column=0, padx=(85,0), pady=(5, 0), sticky="n")
        self.settings_tab_frame_label_toggle_changedecrease.set(self.config_data['decreaseSize'])

        self.CreateToolTip(self.settings_tab_frame_label_toggle_changedecrease, text = 'How much to decrease when using Slow/Speed hotkeys.')

        self.settings_tab_frame_label_toggle_resetdecrease = customtkinter.CTkButton(
            self.settings_tab_frame, image=self.reset_image, text="", width=30, command=self.resetvalue_decreaseSize, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["ButtonHoverColor"]
        )
        self.settings_tab_frame_label_toggle_resetdecrease.grid(row=1, column=0, padx=(140, 0), pady=(35, 0))

        self.settings_tab_frame_label_toggle_decreaseentry = customtkinter.CTkEntry(
            self.settings_tab_frame, placeholder_text="10", width=50, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], border_color=self.activeThemeData["Theme"]["Settings"]["ValueBoxBorderColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ValueBoxBackColor"]
        )
        self.settings_tab_frame_label_toggle_decreaseentry.grid(row=1, column=0, padx=(50,0), pady=(35, 0))
        self.settings_tab_frame_label_toggle_decreaseentry.insert(0, self.config_data['decreaseSize'])

        self.settings_tab_frame_label_toggle_decreaseentry.bind("<FocusOut>", self.slidertoentry_decreaseSize)
        self.settings_tab_frame_label_toggle_decreaseentry.bind("<KeyRelease>", self.slidertoentry_decreaseSize)
        self.settings_tab_frame_label_toggle_changedecrease.bind("<ButtonRelease-1>", self.entrytoslider_decreaseSize)

        self.settings_tab_frame_label_toggle_console = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Console", command=switchConsole, variable=switchConsolevar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_console.grid(row=1, column=0, padx=(20, 0), pady=(0, 0), sticky="nw")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_console, text = 'Displays the notes playing\n(Can cause slight lag while playing)')

        self.settings_tab_frame_label_qwerty = customtkinter.CTkLabel(
            self.settings_tab_frame, text="QWERTY Settings", fg_color="transparent", font=self.global_font20, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_qwerty.grid(row=2, column=0, padx=(10, 0), pady=(10, 0), sticky="w")

        self.settings_tab_frame_label_toggle_sustain = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Sustain", command=switchSustain, variable=switchSustainvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_sustain.grid(row=3, column=0, padx=(20, 0), pady=(5, 0), sticky="w")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_sustain, text = 'Simulates Pedal by "Spacebar"\nOnly works on supported games.')

        self.settings_tab_frame_label_toggle_nodoubles = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="No Doubles", command=switchNoDoubles, variable=switchNoDoublesvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_nodoubles.grid(row=4, column=0, padx=(20, 0), pady=(5, 0), sticky="w")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_nodoubles, text = 'Prevents double-triggering of keys')

        self.settings_tab_frame_label_toggle_velocity = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Velocity", command=switchVelocity, variable=switchVelocityvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_velocity.grid(row=5, column=0, padx=(20, 0), pady=(5, 0), sticky="nw")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_velocity, text = 'Simulates how hard a key is pressed by "CTRL"\nwhich affects the loudness of that note\nOnly works on supported')

        self.settings_tab_frame_label_toggle_88keys = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="88 Keys", command=switch88Keys, variable=switch88Keysvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_88keys.grid(row=5, column=0, padx=(20, 0), pady=(35, 0), sticky="nw")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_88keys, text = 'Process MIDI notes according to the 88-key mapping.')

        self.settings_tab_frame_close_ex_con = customtkinter.CTkButton(
            self.settings_tab_frame, text="Clear MIDI\nList", width=100, command=self.clearMIDI, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["ButtonHoverColor"]
        )
        self.settings_tab_frame_close_ex_con.grid(row=6, column=0, padx=(20, 0), pady=(10, 0), sticky="nw")

        self.CreateToolTip(self.settings_tab_frame_close_ex_con, text = 'Clears the MIDI Files from MIDI File Selector dropdown\nEXCEPT for files inside ./Midis')

        # SETTINGS > HOTKEYS

        self.settings_tab_frame_label_hotkey = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Hotkey Settings", fg_color="transparent", font=self.global_font20, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_hotkey.grid(row=8, column=0, padx=(10, 0), pady=(10, 0), sticky="w")

        self.settings_tab_frame_label_play = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Play", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_play.grid(row=9, column=0, padx=(33, 0), pady=(0, 0), sticky="w")

        self.settings_tab_frame_label_pause = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Pause", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_pause.grid(row=9, column=0, padx=(110, 0), pady=(0, 0), sticky="w")

        self.settings_tab_frame_label_stop = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Stop", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_stop.grid(row=9, column=0, padx=(193, 0), pady=(0, 0), sticky="w")

        self.settings_tab_frame_label_speed = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Slow Down", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_speed.grid(row=9, column=0, padx=(254, 0), pady=(0, 0), sticky="w")

        self.settings_tab_frame_label_slow = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Speed Up", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_slow.grid(row=9, column=0, padx=(340, 0), pady=(0, 0), sticky="w")


        self.settings_tab_frame_play_hotkey = customtkinter.CTkButton(
            self.settings_tab_frame, text=self.config_data.get('playHotkey', 'F1'), width=70, command=self.getPlayHotkey, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorHoverColor"]
        )
        self.settings_tab_frame_play_hotkey.grid(row=10, column=0, padx=(15, 165), pady=(0, 5), sticky="w")


        self.settings_tab_frame_pause_hotkey = customtkinter.CTkButton(
            self.settings_tab_frame, text=self.config_data.get('pauseHotkey', 'F2'), width=70, command=self.getPauseHotkey, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorHoverColor"]
        )
        self.settings_tab_frame_pause_hotkey.grid(row=10, column=0, padx=(95, 165), pady=(0, 5), sticky="w")


        self.settings_tab_frame_stop_hotkey = customtkinter.CTkButton(
            self.settings_tab_frame, text=self.config_data.get('stopHotkey', 'F3'), width=70, command=self.getStopHotkey, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorHoverColor"]
        )
        self.settings_tab_frame_stop_hotkey.grid(row=10, column=0, padx=(175, 165), pady=(0, 5), sticky="w")


        self.settings_tab_frame_speed_hotkey = customtkinter.CTkButton(
            self.settings_tab_frame, text=self.config_data.get('speedHotkey', 'F4'), width=70, command=self.getSpeedUpHotkey, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorHoverColor"]
        )
        self.settings_tab_frame_speed_hotkey.grid(row=10, column=0, padx=(255, 165), pady=(0, 5), sticky="w")


        self.settings_tab_frame_slow_hotkey = customtkinter.CTkButton(
            self.settings_tab_frame, text=self.config_data.get('slowHotkey', 'F5'), width=70, command=self.getSlowDownHotkey, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["HotkeySelectorHoverColor"]
        )
        self.settings_tab_frame_slow_hotkey.grid(row=10, column=0, padx=(337, 165), pady=(0, 5), sticky="w")

        self.settings_tab_miscellaneous = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Miscellaneous", fg_color="transparent", font=self.global_font20, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_miscellaneous.grid(row=4, column=0, padx=(85,0), pady=(0, 5), sticky="n")

        self.settings_tab_frame_label_toggle_tooltip = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Tooltip", command=switchTooltip, variable=switchTooltipvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_tooltip.grid(row=5, column=0, padx=(115,0), pady=(0, 60), sticky="s")

        if os_name == "Darwin":
            self.settings_tab_frame_label_toggle_tooltip.configure(state="disabled")
            switchTooltipvar.set("off")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_tooltip, text = 'Disables me :(')

        self.settings_tab_frame_label_toggle_loopSong = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Loop Song", command=switchLoopSong, variable=switchLoopSongvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_loopSong.grid(row=5, column=0, padx=(100,0), pady=(0, 30), sticky="s")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_loopSong, text = 'Repeats the song when it ends')

        self.settings_tab_frame_label_toggle_randomFail = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Random Fail", command=switchRandomFail, variable=switchRandomFailvar, font=self.global_font, onvalue="on", offvalue="off", fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"], progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"], button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_randomFail.grid(row=5, column=0, padx=(85,0), pady=(0, 0), sticky="s")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_randomFail, text = 'Randomly fails some notes by "Speed" or "Velocity" to seem legit')

        self.settings_tab_frame_failspeedprclvl = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Speed Fail %", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_failspeedprclvl.grid(row=6, column=0, padx=(150,0), pady=(0, 0), sticky="nw")

        self.settings_tab_frame_speedfailspeedprcslider = customtkinter.CTkSlider(self.settings_tab_frame, from_=0, to=100, width=125, command=self.sliderupdate_failspeedprc, fg_color=self.activeThemeData["Theme"]["Settings"]["SliderBackColor"], progress_color=self.activeThemeData["Theme"]["Settings"]["SliderFillColor"], button_color=self.activeThemeData["Theme"]["Settings"]["SliderCircleColor"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SliderCircleHoverColor"])
        self.settings_tab_frame_speedfailspeedprcslider.grid(row=7, column=0, padx=(140,0), pady=(5, 0), sticky="nw")
        self.settings_tab_frame_speedfailspeedprcslider.set(self.config_data['failType']['speed'])

        self.CreateToolTip(self.settings_tab_frame_speedfailspeedprcslider, text = 'Slows Down/Speeds Up at random notes')

        self.settings_tab_frame_failspeedprcreset = customtkinter.CTkButton(
            self.settings_tab_frame, image=self.reset_image, text="", width=30, command=self.resetvalue_failspeedprc, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["ButtonHoverColor"]
        )
        self.settings_tab_frame_failspeedprcreset.grid(row=6, column=0, padx=(210, 0), pady=(25, 0), sticky="nw")

        self.settings_tab_frame_failspeedprcint = customtkinter.CTkEntry(
            self.settings_tab_frame, placeholder_text="10", width=50, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], border_color=self.activeThemeData["Theme"]["Settings"]["ValueBoxBorderColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ValueBoxBackColor"]
        )
        self.settings_tab_frame_failspeedprcint.grid(row=6, column=0, padx=(155,0), pady=(25, 0), sticky="nw")
        self.settings_tab_frame_failspeedprcint.insert(0, self.config_data['failType']['speed'])

        self.settings_tab_frame_failspeedprcint.bind("<FocusOut>", self.slidertoentry_failspeedprc)
        self.settings_tab_frame_failspeedprcint.bind("<KeyRelease>", self.slidertoentry_failspeedprc)
        self.settings_tab_frame_speedfailspeedprcslider.bind("<ButtonRelease-1>", self.entrytoslider_failspeedprc)

        self.settings_tab_frame_trpsprclvl = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Transpose Fail %", fg_color="transparent", font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_trpsprclvl.grid(row=6, column=0, padx=(85,0), pady=(0, 0), sticky="n")

        self.settings_tab_frame_trpsprcslider = customtkinter.CTkSlider(self.settings_tab_frame, from_=0, to=100, width=125, command=self.sliderupdate_TrpsInt, fg_color=self.activeThemeData["Theme"]["Settings"]["SliderBackColor"], progress_color=self.activeThemeData["Theme"]["Settings"]["SliderFillColor"], button_color=self.activeThemeData["Theme"]["Settings"]["SliderCircleColor"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["SliderCircleHoverColor"])
        self.settings_tab_frame_trpsprcslider.grid(row=7, column=0, padx=(85,0), pady=(5, 0), sticky="n")
        self.settings_tab_frame_trpsprcslider.set(self.config_data['failType']['transpose'])

        self.CreateToolTip(self.settings_tab_frame_trpsprcslider, text = 'Randomizes the velocity of random notes')

        self.settings_tab_frame_toggle_trpsprcreset = customtkinter.CTkButton(
            self.settings_tab_frame, image=self.reset_image, text="", width=30, command=self.resetvalue_TrpsInt, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ButtonColor"], hover_color=self.activeThemeData["Theme"]["Settings"]["ButtonHoverColor"]
        )
        self.settings_tab_frame_toggle_trpsprcreset.grid(row=6, column=0, padx=(140, 0), pady=(25, 0))

        self.settings_tab_frame_toggle_trpsprcint = customtkinter.CTkEntry(
            self.settings_tab_frame, placeholder_text="10", width=50, font=self.global_font, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], border_color=self.activeThemeData["Theme"]["Settings"]["ValueBoxBorderColor"], fg_color=self.activeThemeData["Theme"]["Settings"]["ValueBoxBackColor"]
        )
        self.settings_tab_frame_toggle_trpsprcint.grid(row=6, column=0, padx=(50,0), pady=(25, 0))
        self.settings_tab_frame_toggle_trpsprcint.insert(0, self.config_data['failType']['transpose'])

        self.settings_tab_frame_toggle_trpsprcint.bind("<FocusOut>", self.slidertoentry_TrpsInt)
        self.settings_tab_frame_toggle_trpsprcint.bind("<KeyRelease>", self.slidertoentry_TrpsInt)
        self.settings_tab_frame_trpsprcslider.bind("<ButtonRelease-1>", self.entrytoslider_TrpsInt)

        # THEME

        themeName = self.activeThemeData["Name"]
        os.makedirs(f"{base_directory}/assets/customThemes", exist_ok=True)

        if themeName not in self.themeNames:
            self.themeNames.append(themeName)

        for filename in os.listdir(f"{base_directory}/assets/customThemes"):
            if filename.endswith('.json'):
                theme_name = filename + " (Custom)"
                if theme_name and theme_name not in self.themeNames:
                    self.themeNames.append(theme_name)

        def switchTheme(event=None):
            value = self.settings_tab_frame_theme_selector.get()
            self.config_data['forceTheme'] = False
            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

            self.stop_playback()
            self.destroy()

            if "(Custom)" not in value:
                response = requests.get("https://api.nanomidi.net/api/nanomidiplayer/theme")
                
                if response.status_code == 200:
                    theme_data = response.json()
                    available_themes = theme_data["availableThemes"]

                    if value in available_themes:
                        theme_url = available_themes[value]
                        
                        theme_response = requests.get(theme_url)
                        
                        if theme_response.status_code == 200:
                            with open(theme_path, 'w') as active_theme_file:
                                active_theme_file.write(theme_response.text)
                        else:
                            print(f"FAIL > {theme_url}. Code: ({theme_response.status_code})")
                    else:
                        print(f"'{value}' does not exist.")
                else:
                    print(f"Failed ({response.status_code})")
            else:
                custom_theme_name = value.replace(" (Custom)", "")
                custom_theme_path = os.path.join('assets', 'customThemes', custom_theme_name)

                if os.path.isfile(custom_theme_path):
                    with open(custom_theme_path, 'r') as custom_theme_file:
                        custom_theme_data = custom_theme_file.read()

                    with open(theme_path, 'w') as active_theme_file:
                        active_theme_file.write(custom_theme_data)
                else:
                    print(f"'{custom_theme_path}' does not exist.")

            new_app = App()
            new_app.mainloop()

            self.stop_playback()
            self.destroy()
            new_app = App()
            new_app.mainloop()

        self.settings_tab_frame_label_theme = customtkinter.CTkLabel(
            self.settings_tab_frame, text="Theme", fg_color="transparent", font=self.global_font20, text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"]
        )
        self.settings_tab_frame_label_theme.grid(row=11, column=0, padx=(10, 0), pady=(10, 0), sticky="w")

        self.settings_tab_frame_label_toggle_forceTheme = customtkinter.CTkSwitch(
            self.settings_tab_frame, text="Force API Theme", command=switchForceTheme, variable=switchForceThemevar,
            font=self.global_font, onvalue="on", offvalue="off",
            fg_color=self.activeThemeData["Theme"]["Settings"]["SwitchDisabled"],
            progress_color=self.activeThemeData["Theme"]["Settings"]["SwitchEnabled"],
            button_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircle"],
            button_hover_color=self.activeThemeData["Theme"]["Settings"]["SwitchCircleHovered"],
            text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"],
            text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )
        self.settings_tab_frame_label_toggle_forceTheme.grid(row=11, column=0, padx=(65, 0), pady=(0, 0), sticky="s")

        self.CreateToolTip(self.settings_tab_frame_label_toggle_forceTheme, text = 'Automatically fetch theme from nanomidi.net')

        self.settings_tab_frame_theme_selector = customtkinter.CTkOptionMenu(
            self.settings_tab_frame, width=380, command=switchTheme, values=self.themeNames, font=self.global_font, dropdown_font=self.global_font, fg_color=self.activeThemeData["Theme"]["Settings"]["OptionBackColor"], dropdown_fg_color=self.activeThemeData["Theme"]["Settings"]["OptionDropdownBackground"], button_color=self.activeThemeData["Theme"]["Settings"]["OptionDropdownButtonColor"], button_hover_color=self.activeThemeData["Theme"]["Settings"]["OptionDropdownButtonHoverColor"], text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], dropdown_text_color=self.activeThemeData["Theme"]["Settings"]["TextColor"], text_color_disabled=self.activeThemeData["Theme"]["Settings"]["TextColorDisabled"]
        )

        self.settings_tab_frame_theme_selector.set(themeName)

        self.settings_tab_frame_theme_selector.grid(row=12, column=0, padx=(0, 150), pady=(5, 15))

        print(themeName)

        # MIDI HUB

        self.midi_hub_frame = customtkinter.CTkScrollableFrame(self.master, corner_radius=0, fg_color=self.activeThemeData["Theme"]["MIDIHub"]["BackgroundColor"])
        self.midi_hub_frame.grid_columnconfigure(0, weight=1)

        self.downloadimagefile = customtkinter.CTkImage(downloadimage, size=(18, 18))
        self.searchimagefile = customtkinter.CTkImage(searchimage, size=(18, 18))

        self.midi_data_url = "https://api.nanomidi.net/api/midiData"
        self.image_base_url = "https://api.nanomidi.net/api/images/"

        self.page_size = 10
        self.current_page = 1

        def searchBar(event=None):
            threading.Thread(target=self.filter_midi_data, args=(event,)).start()

        self.midi_hub_searchbar = customtkinter.CTkEntry(self.midi_hub_frame, placeholder_text="Search", width=225, font=self.global_font, fg_color=self.activeThemeData["Theme"]["MIDIHub"]["SearchBarColor"], text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"], border_color=self.activeThemeData["Theme"]["MIDIHub"]["SearchBarBorderColor"])
        self.midi_hub_searchbar.grid(row=0, column=0, padx=20, pady=(10, 0), sticky="w")
        self.midi_hub_searchbar.bind("<Return>", searchBar)

        self.search_button = customtkinter.CTkButton(master=self.midi_hub_frame, text="", fg_color=self.activeThemeData["Theme"]["MIDIHub"]["SearchButtonColor"], hover_color=self.activeThemeData["Theme"]["MIDIHub"]["SearchButtonHoverColor"], width=24, height=24, command=self.searchButton, image=self.searchimagefile)
        self.search_button.grid(row=0, column=0, padx=20, pady=(10, 0), sticky="e")

        def sort_combo_command(value):
            threading.Thread(target=self.sort_midi_data, args=(value,)).start()
        self.sort_combo = customtkinter.CTkComboBox(master=self.midi_hub_frame, values=["Newest", "Oldest"], text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"], button_color=self.activeThemeData["Theme"]["MIDIHub"]["SortOptionDropdownButtonColor"], fg_color=self.activeThemeData["Theme"]["MIDIHub"]["SortOptionBackColor"], dropdown_fg_color=self.activeThemeData["Theme"]["MIDIHub"]["SortOptionDropdownBackground"], dropdown_font=self.global_font,command=sort_combo_command, width=100, font=self.global_font, button_hover_color=self.activeThemeData["Theme"]["MIDIHub"]["SortOptionDropdownButtonHoverColor"], dropdown_hover_color=self.activeThemeData["Theme"]["MIDIHub"]["SortOptionDropdownItemHover"], border_color=self.activeThemeData["Theme"]["MIDIHub"]["SortOptionBorderColor"])
        self.sort_combo.grid(row=0, column=0, padx=60, pady=(10, 0), sticky="e")

        self.download_folder = "Midis"
        if os_name == "Darwin":
            self.download_folder = os.path.join(base_directory, self.download_folder)

            if not os.path.exists(self.download_folder):
                os.makedirs(self.download_folder)
        else:
            if not os.path.exists(self.download_folder):
                os.makedirs(self.download_folder)

        # PERMISSION

        def is_accessibility_allowed():
            script = '''
                tell application "System Events"
                    set uiEnabled to UI elements enabled
                end tell
                return uiEnabled
                '''
            result = subprocess.run(["osascript", "-e", script], capture_output=True, text=True)
            return "true" in result.stdout.lower()

        def accessibility():
            subprocess.run(["open", "x-apple.systempreferences:com.apple.preference.security?Privacy_Accessibility"])

        def input_monitoring():
            subprocess.run(["open", "x-apple.systempreferences:com.apple.preference.security?Privacy_ListenEvent"])

        if os_name == "Darwin" and not is_input_trusted or not is_accessibility_allowed:
            self.permission_tab = customtkinter.CTkButton(
                self.navigation_frame, corner_radius=0, height=40, border_spacing=10, text="PERMISSIONS\nREQUIRED!",
                fg_color="#6E0000", text_color=("gray90", "gray90"), hover_color="#4D0000",
                image=self.padlockimage, anchor="w", font=self.global_font, command=self.permission_tab_event
            )
            self.permission_tab.grid(row=6, column=0)

        self.permission_tab_frame = customtkinter.CTkFrame(self.master, corner_radius=0, fg_color="#0A0A0A")
        self.permission_tab_frame.grid_columnconfigure(0, weight=1)

        self.permission_tab_frame_label = customtkinter.CTkLabel(
            self.permission_tab_frame, text="Required Permissions for macOS", fg_color="transparent", font=self.global_font20
        )
        self.permission_tab_frame_label.grid(row=0, column=0, padx=(0, 0), pady=(10, 0), sticky="ns")

        self.accessibility_button = customtkinter.CTkButton(self.permission_tab_frame, width=350, text="Allow Accessibility Permission",
                                                            command=accessibility)

        self.accessibility_image = customtkinter.CTkButton(master=self.permission_tab_frame, text="", fg_color="white", width=100, height=100, state="disabled", image=self.accessibilityimage)
        self.inputmonitor_image = customtkinter.CTkButton(master=self.permission_tab_frame, text="", fg_color="white", width=100, height=100, state="disabled", image=self.inputmonitorimage)


        self.input_monitoring_button = customtkinter.CTkButton(self.permission_tab_frame, width=350, text="Allow Input Monitoring Permission",
                                                               command=input_monitoring)

        self.accessibility_image.grid(row=1, column=0, pady=(10, 0), sticky="ns")
        self.accessibility_button.grid(row=2, padx=0, pady=(10, 0), sticky="ns")

        self.inputmonitor_image.grid(row=3, column=0, pady=(10, 0), sticky="ns")
        self.input_monitoring_button.grid(row=4, padx=0, pady=(10, 0), sticky="ns")

        self.permission_tab_frame_label2 = customtkinter.CTkLabel(
            self.permission_tab_frame, text="Accessibility is required for keypress automation\n\nInput Monitoring is required for Play/Pause, etc hotkeys", fg_color="transparent",
            font=self.global_font12
        )
        self.permission_tab_frame_label2.grid(row=6, column=0, padx=(0, 0), pady=(10, 0), sticky="n")

        if os_name == "Darwin" and is_accessibility_allowed():
            self.accessibility_button.configure(state="disabled", text="Accessibility Permission Granted")

        if os_name == "Darwin" and is_input_trusted:
            self.input_monitoring_button.configure(state="disabled", text="Input Monitoring Permission Granted")

        # END

        added = self.config_data.get('addedMIDI', [])

        midiDIR = [
            os.path.join(self.download_folder, file)
            for file in os.listdir(self.download_folder)
            if file.endswith('.mid') or file.endswith('.midi')
        ]

        allMidis = added + midiDIR

        currentVAL = list(self.home_frame_entry_1.cget("values"))

        uniqueMIDI = set(currentVAL + allMidis)
        currentVAL = list(uniqueMIDI)

        self.home_frame_entry_1.configure(values=currentVAL)

        if currentVAL:
            self.home_frame_entry_1.configure(values=currentVAL)
            self.home_frame_entry_1.set(currentVAL[0])
        else:
            self.home_frame_entry_1.configure(values=[])
            self.home_frame_entry_1.set('')

        def destroyMessage():
            self.warning.destroy()

        if update_status == "urgent":
            self.warning = customtkinter.CTkButton(
                self.home_frame, text=f"VERSION WARNING!\n\n{urgent_message}\n\n[CLICK HERE TO IGNORE]", fg_color="#FF0000", hover_color="#8B0000", command=destroyMessage, font=self.global_font
            )
            self.warning.grid(row=0, column=0, padx=(0,0), pady=(10,0), sticky="ns")
            self.warning._text_label.configure(wraplength=300)

            self.updateAvailable = customtkinter.CTkButton(
                self.navigation_frame, text="Update Available", fg_color="#FF0000", hover_color="#8B0000", command=redirectUpdate, font=self.global_font
            )
            self.updateAvailable.grid(row=7, column=0, padx=(0,0), pady=(0,5), sticky="n")

        if self.config_data['console']:
            self.consolekl_text_insert_ignorefalse("If playback is laggy",)
            self.consolekl_text_insert_ignorefalse("Consider disabling this :)")
        else:
            self.consolekl_text_insert_ignorefalse("Disabled")

        if self.config_data['topMost']:
            self.attributes('-topmost', True)
        else:
            self.attributes('-topmost', False)

        def ctrlO():
            if not self.isRunning:
                self.open_file_dialog()

        if not os_name == "Darwin":
            kb.add_hotkey('ctrl+O', ctrlO)

        self.select_frame_by_name("home")
        self.hasMIDI()
        self.useMIDIStatus()

    def clearMIDI(self, event=None):
        self.config_data["addedMIDI"] = []
        with open(config_path, 'w') as file:
            json.dump(self.config_data, file, indent=2)

    def searchButton(self, event=None):
        self.filter_midi_data(event)

    def load_midi_data(self):
        response = requests.get(self.midi_data_url)
        self.all_midi_data = response.json()
        self.all_midi_data.reverse()
        self.filtered_midi_data = self.all_midi_data
        self.total_pages = (len(self.filtered_midi_data) + self.page_size - 1) // self.page_size

        self.show_page(self.current_page)

    def fetch_image(self, midi):
        image_url = self.image_base_url + midi["imageFilename"]
        response = requests.get(image_url, stream=True)
        return customtkinter.CTkImage(Image.open(response.raw), size=(100, 100))

    def sort_midi_data(self, selected_value):
        for widget in self.midi_hub_frame.winfo_children():
            if widget != self.midi_hub_searchbar and \
            (not hasattr(self, 'search_button') or widget != self.search_button) and \
            (not hasattr(self, 'sort_combo') or widget != self.sort_combo):
                widget.destroy()

        please_wait = customtkinter.CTkLabel(
            self.midi_hub_frame, text="Please Wait...", text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
            compound="left", font=self.global_font40
        )
        please_wait.grid(row=1, column=0, padx=10, pady=(150,0), sticky="nsew")
        please_wait2 = customtkinter.CTkLabel(
            self.midi_hub_frame, text="Fetching from nanomidi.net...", text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
            compound="left", font=self.global_font
        )
        please_wait2.grid(row=2, column=0, padx=10, pady=(150,0), sticky="nsew")

        self.midi_hub_frame.update()
                
        if selected_value == "Newest":
            self.all_midi_data.reverse()
        elif selected_value == "Oldest":
            self.all_midi_data.reverse()

        self.filtered_midi_data = self.all_midi_data
        self.total_pages = (len(self.filtered_midi_data) + self.page_size - 1) // self.page_size
        self.show_page(self.current_page)

    def show_page(self, page):
        for widget in self.midi_hub_frame.winfo_children():
            if widget != self.midi_hub_searchbar and \
            (not hasattr(self, 'search_button') or widget != self.search_button) and \
            (not hasattr(self, 'sort_combo') or widget != self.sort_combo):
                widget.destroy()

        self.midi_hub_frame.update()

        start_index = (page - 1) * self.page_size
        end_index = min(start_index + self.page_size, len(self.filtered_midi_data))

        with concurrent.futures.ThreadPoolExecutor() as executor:
            future_to_midi = {
                executor.submit(self.fetch_image, midi): midi for midi in self.filtered_midi_data[start_index:end_index]
            }

            for index, future in enumerate(concurrent.futures.as_completed(future_to_midi), start=1):
                midi = future_to_midi[future]
                try:
                    midi_image = future.result()
                except Exception as exc:
                    print(f"Error loading image for {midi['name']}: {exc}")
                    midi_image = None

                #self.create_midi_frame(index, midi, midi_image)
                threading.Thread(target=self.create_midi_frame, args=(index, midi, midi_image,)).start()

        self.midi_hub_footer()

    def create_midi_frame(self, row, midi, midi_image):
        midi_frame = customtkinter.CTkFrame(master=self.midi_hub_frame, height=100, fg_color=self.activeThemeData["Theme"]["MIDIHub"]["MidiCardBackColor"])
        midi_frame.grid(row=row, column=0, padx=20, pady=5, sticky="nsew")

        midi_image_button = customtkinter.CTkButton(
            master=midi_frame, text="", fg_color="transparent", width=100, height=100,
            state="disabled", image=midi_image
        )
        midi_image_button.grid(row=0, column=0, sticky="w")

        midi_name = customtkinter.CTkLabel(
            midi_frame, text=midi["name"],
            compound="left", font=self.global_font, text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"]
        )
        midi_name.grid(row=0, column=0, padx=120, pady=(0, 80), sticky="w")

        midi_artist = customtkinter.CTkLabel(
            midi_frame, text=midi["artists"], text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
            compound="left", font=self.global_font12
        )
        midi_artist.grid(row=0, column=0, padx=120, pady=(0, 35), sticky="w")

        midi_arr = customtkinter.CTkLabel(
            midi_frame, text="Arr: " + (midi["arranger"] if midi["arranger"] else "N/A"),
            compound="left", font=self.global_font11, text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"]
        )
        midi_arr.grid(row=0, column=0, padx=120, pady=(40, 0), sticky="w")

        midi_uploadedby = customtkinter.CTkLabel(
            midi_frame, text="Uploader: " + midi["uploader"],
            compound="left", font=self.global_font11, text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"]
        )
        midi_uploadedby.grid(row=0, column=0, padx=120, pady=(80, 0), sticky="w")

        midi_filename = midi["midiFilename"]
        if midi_filename:
            download_url = "https://api.nanomidi.net/api/midis/" + midi_filename
            midi_download = customtkinter.CTkButton(
                master=midi_frame, text="", fg_color=self.activeThemeData["Theme"]["MIDIHub"]["DownloadButtonColor"], hover_color=self.activeThemeData["Theme"]["MIDIHub"]["DownloadButtonHoverColor"], width=24, height=24,
                image=self.downloadimagefile, command=lambda url=download_url: self.download_midi(url)
            )
            midi_download.grid(row=0, column=0, padx=330, pady=(75, 0), sticky="e")

    def download_midi(self, url):
        response = requests.get(url)
        filename = url.split("/")[-1]
        filepath = os.path.join(self.download_folder, filename)
        self.config_data['midiFile'] = filepath

        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

        with open(filepath, "wb") as f:
            f.write(response.content)

        self.ignore_key_press = True
        self.stop_playback()

        current_values = list(self.home_frame_entry_1.cget("values"))

        if filepath not in current_values:
            current_values.append(filepath)
            self.home_frame_entry_1.configure(values=current_values)

        self.home_frame_entry_1.set(filepath)

        self.select_frame_by_name("home")

        midi_file = MidiFile(filepath)
        self.total_time = midi_file.length

        self.timelineTextLoadMIDI = (
            f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}"
            if self.config_data['timestamp']
            else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
        )

        self.timeline.configure(text=self.timelineTextLoadMIDI)

        threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=("Downloaded!",)).start()
        threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(filename,)).start()

        self.ignore_key_press = False


    def midi_hub_footer(self):
        pagination_frame = customtkinter.CTkFrame(master=self.midi_hub_frame, fg_color=self.activeThemeData["Theme"]["MIDIHub"]["PageControlFrameBackground"])
        pagination_frame.grid(row=self.page_size + 1, column=0, padx=20, pady=5, sticky="nsew")

        prev_button = customtkinter.CTkButton(master=pagination_frame, text="Previous", width=118, font=self.global_font, command=self.prev_page, text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"], fg_color=self.activeThemeData["Theme"]["MIDIHub"]["PreviousButtonColor"], hover_color=self.activeThemeData["Theme"]["MIDIHub"]["PreviousButtonHoverColor"])
        prev_button.grid(row=0, column=0, padx=9, pady=10)

        page_label = customtkinter.CTkLabel(master=pagination_frame, text=f"Page {self.current_page}/{self.total_pages}", font=self.global_font, text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"])
        page_label.grid(row=0, column=1, padx=(13, 0), pady=10)

        next_button = customtkinter.CTkButton(master=pagination_frame, text="Next", font=self.global_font, width=118, command=self.next_page, text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"], fg_color=self.activeThemeData["Theme"]["MIDIHub"]["NextButtonColor"], hover_color=self.activeThemeData["Theme"]["MIDIHub"]["NextButtonHoverColor"])
        next_button.grid(row=0, column=2, padx=18, pady=10)

    def prev_page(self):
        if self.current_page > 1:
            self.current_page -= 1
            threading.Thread(target=self.show_page, args=(self.current_page,)).start()

    def next_page(self):
        if self.current_page < self.total_pages:
            self.current_page += 1
            threading.Thread(target=self.show_page, args=(self.current_page,)).start()

    def filter_midi_data(self, event):
        for widget in self.midi_hub_frame.winfo_children():
            if widget != self.midi_hub_searchbar and \
            (not hasattr(self, 'search_button') or widget != self.search_button) and \
            (not hasattr(self, 'sort_combo') or widget != self.sort_combo):
                widget.destroy()
        please_wait = customtkinter.CTkLabel(
            self.midi_hub_frame, text="Please Wait...", text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
            compound="left", font=self.global_font40
        )
        please_wait.grid(row=1, column=0, padx=10, pady=(150,0), sticky="nsew")
        please_wait2 = customtkinter.CTkLabel(
            self.midi_hub_frame, text="Fetching from nanomidi.net...", text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
            compound="left", font=self.global_font
        )
        please_wait2.grid(row=2, column=0, padx=10, pady=(150,0), sticky="nsew")

        self.midi_hub_frame.update()

        search_query = self.midi_hub_searchbar.get().lower()
        self.filtered_midi_data = [
            midi for midi in self.all_midi_data
            if search_query in midi["name"].lower() or search_query in midi["artists"].lower()
        ]
        self.total_pages = (len(self.filtered_midi_data) + self.page_size - 1) // self.page_size
        self.current_page = 1
        self.show_page(self.current_page)

    def start_listener(self):
        self.listener = Listener(on_press=self.on_key_press)
        self.listener.start()

    def on_key_press(self, key):
        if self.ignore_key_press:
            return

        try:
            if hasattr(key, 'char') and key.char:
                key_str = key.char.upper()
            else:
                key_str = str(key).replace('Key.', '').upper()
                key_str = self.special_key_map.get(key_str, key_str)
            #print(key_str)

            if key_str == self.hotkeys['play']:
                self.toggle_playback()
            elif key_str == self.hotkeys['pause']:
                self.pause_playback()
            elif key_str == self.hotkeys['stop']:
                self.stop_playback()
            elif key_str == self.hotkeys['speed']:
                self.speedup_playback()
            elif key_str == self.hotkeys['slow']:
                self.slowdown_playback()
        except Exception as e:
            print(f"Error handling key press: {e}")

    def get_hotkey(self, hotkey_name, label):
        self.ignore_key_press = True
        self.updateCloneLabel(hotkey_name)

        label.configure(text="Press Key")
        self.bind("<Key>", lambda event: self.set_hotkey(event, hotkey_name, label))

    def set_hotkey(self, event, hotkey_name, label):
        new_hotkey = event.keysym.upper()
        new_hotkey = self.special_key_map.get(new_hotkey, new_hotkey)
        label.configure(text=new_hotkey)
        self.hotkeys[hotkey_name] = new_hotkey
        self.config_data[f'{hotkey_name}Hotkey'] = new_hotkey

        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

        self.updateClonedButton(hotkey_name, new_hotkey)
        self.unbind("<Key>")
        self.ignore_key_press = False

    def updateClonedButton(self, hotkey_name, new_hotkey):
        clones = {
            'play': ['settings_tab_frame_play_hotkey'],
            'pause': ['settings_tab_frame_pause_hotkey'],
            'stop': ['settings_tab_frame_stop_hotkey'],
            'speed': ['settings_tab_frame_speed_hotkey'],
            'slow': ['settings_tab_frame_slow_hotkey']
        }

        for clone_name in clones.get(hotkey_name, []):
            clone_label = getattr(self, clone_name, None)
            if clone_label:
                clone_label.configure(text=new_hotkey)

    def updateCloneLabel(self, hotkey_name):
        label = getattr(self, f'{hotkey_name}_hotkey', None)
        if label:
            label.configure(text="Press Key")

        clones = {
            'play': ['settings_tab_frame_play_hotkey'],
            'pause': ['settings_tab_frame_pause_hotkey'],
            'stop': ['settings_tab_frame_stop_hotkey'],
            'speed': ['settings_tab_frame_speed_hotkey'],
            'slow': ['settings_tab_frame_slow_hotkey']
        }

        for clone_name in clones.get(hotkey_name, []):
            clone_label = getattr(self, clone_name, None)
            if clone_label:
                clone_label.configure(text="Press Key")

    def hasMIDI(self):
        midi_file = self.config_data.get('midiFile')
        if midi_file and os.path.exists(midi_file):
            currentVAL = list(self.home_frame_entry_1.cget("values"))
            if midi_file not in currentVAL:
                currentVAL.append(midi_file)
                self.home_frame_entry_1.configure(values=currentVAL)

            self.home_frame_entry_1.set(midi_file)

            midifile = MidiFile(midi_file)
            self.total_time = midifile.length
            self.timelineTextLoadMIDI = f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}" if self.config_data['timestamp'] else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
            self.timeline.configure(text=self.timelineTextLoadMIDI)

            self.set_hotkeys()

    def set_hotkeys(self):
        self.hotkeys['play'] = self.config_data.get('playHotkey')
        self.hotkeys['pause'] = self.config_data.get('pauseHotkey')
        self.hotkeys['stop'] = self.config_data.get('stopHotkey')
        self.hotkeys['speed'] = self.config_data.get('speedHotkey')
        self.hotkeys['slow'] = self.config_data.get('slowHotkey')

    def update_hotkey(self, key_type, new_hotkey):
        self.hotkeys[key_type] = new_hotkey
        self.config_data[f'{key_type}Hotkey'] = new_hotkey
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

        self.set_hotkeys()

    def useMIDIStatus(self, event=None):
        if not self.config_data.get('useMIDI', False):
            self.home_frame_combobox_1.configure(state="disabled")
            self.home_frame_label_1_toggle_sustain.configure(state="normal")
            self.home_frame_label_1_toggle_nodoubles.configure(state="normal")
            self.home_frame_label_1_toggle_velocity.configure(state="normal")
            self.home_frame_label_1_toggle_88keys.configure(state="normal")

            self.settings_tab_frame_label_toggle_sustain.configure(state="normal")
            self.settings_tab_frame_label_toggle_nodoubles.configure(state="normal")
            self.settings_tab_frame_label_toggle_velocity.configure(state="normal")
            self.settings_tab_frame_label_toggle_88keys.configure(state="normal")
        else:
            self.home_frame_combobox_1.configure(state="normal")
            self.home_frame_label_1_toggle_sustain.configure(state="disabled")
            self.home_frame_label_1_toggle_nodoubles.configure(state="disabled")
            self.home_frame_label_1_toggle_velocity.configure(state="disabled")
            self.home_frame_label_1_toggle_88keys.configure(state="disabled")

            self.settings_tab_frame_label_toggle_sustain.configure(state="disabled")
            self.settings_tab_frame_label_toggle_nodoubles.configure(state="disabled")
            self.settings_tab_frame_label_toggle_velocity.configure(state="disabled")
            self.settings_tab_frame_label_toggle_88keys.configure(state="disabled")

    def playButtonCommand(self, event=None):
        if self.isRunning:
            self.pause_playback(self)
        else:
            self.toggle_playback()

    def sliderupdate(self, value):
        rounded_value = round(float(value))
        self.speedtext.delete(0, "end")
        self.speedtext.insert(0, str(rounded_value))
        self.playback_speed = min(500, rounded_value)

    def slidertoentry(self, event=None):
        try:
            value = float(self.speedtext.get())
            if 10 <= value <= 500:
                self.speed.set(value)
        except ValueError:
            pass

    def entrytoslider(self, event):
        value = self.speed.get()
        self.speedtext.delete(0, "end")
        self.speedtext.insert(0, str(value))

    def slidertoentry_decreaseSize(self, event=None):
        try:
            value = int(float(self.settings_tab_frame_label_toggle_decreaseentry.get()))
            if 1 <= value <= 100:
                self.settings_tab_frame_label_toggle_changedecrease.set(value)
                self.config_data['decreaseSize'] = value
                with open(config_path, 'w') as config_file:
                    json.dump(self.config_data, config_file, indent=2)
        except ValueError:
            pass

    def sliderupdate_decreaseSize(self, value):
        rounded_value = int(round(float(value)))
        self.settings_tab_frame_label_toggle_decreaseentry.delete(0, "end")
        self.settings_tab_frame_label_toggle_decreaseentry.insert(0, str(rounded_value))

        self.config_data['decreaseSize'] = rounded_value
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def entrytoslider_decreaseSize(self, event):
        value = int(self.settings_tab_frame_label_toggle_changedecrease.get())
        self.settings_tab_frame_label_toggle_decreaseentry.delete(0, "end")
        self.settings_tab_frame_label_toggle_decreaseentry.insert(0, str(value))

        self.config_data['decreaseSize'] = value
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def resetvalue_decreaseSize(self):
        self.settings_tab_frame_label_toggle_decreaseentry.delete(0, "end")
        self.settings_tab_frame_label_toggle_decreaseentry.insert(0, "10")
        self.settings_tab_frame_label_toggle_changedecrease.set(10)

        self.config_data['decreaseSize'] = 10
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def slidertoentry_TrpsInt(self, event=None):
        try:
            value = int(float(self.settings_tab_frame_toggle_trpsprcint.get()))
            if 0 <= value <= 100:
                self.settings_tab_frame_trpsprcslider.set(value)
                self.config_data['failType']['transpose'] = value
                with open(config_path, 'w') as config_file:
                    json.dump(self.config_data, config_file, indent=2)
        except ValueError:
            pass

    def sliderupdate_TrpsInt(self, value):
        rounded_value = int(round(float(value)))
        self.settings_tab_frame_toggle_trpsprcint.delete(0, "end")
        self.settings_tab_frame_toggle_trpsprcint.insert(0, str(rounded_value))

        self.config_data['failType']['transpose'] = rounded_value
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def entrytoslider_TrpsInt(self, event):
        value = int(self.settings_tab_frame_trpsprcslider.get())
        self.settings_tab_frame_toggle_trpsprcint.delete(0, "end")
        self.settings_tab_frame_toggle_trpsprcint.insert(0, str(value))

        self.config_data['failType']['transpose'] = value
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def resetvalue_TrpsInt(self):
        self.settings_tab_frame_toggle_trpsprcint.delete(0, "end")
        self.settings_tab_frame_toggle_trpsprcint.insert(0, "30")
        self.settings_tab_frame_trpsprcslider.set(30)

        self.config_data['failType']['transpose'] = 30
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def slidertoentry_failspeedprc(self, event=None):
        try:
            value = int(float(self.settings_tab_frame_failspeedprcint.get()))
            if 0 <= value <= 100:
                self.settings_tab_frame_speedfailspeedprcslider.set(value)
                self.config_data['failType']['speed'] = value
                with open(config_path, 'w') as config_file:
                    json.dump(self.config_data, config_file, indent=2)
        except ValueError:
            pass

    def sliderupdate_failspeedprc(self, value):
        rounded_value = int(round(float(value)))
        self.settings_tab_frame_failspeedprcint.delete(0, "end")
        self.settings_tab_frame_failspeedprcint.insert(0, str(rounded_value))

        self.config_data['failType']['speed'] = rounded_value
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def entrytoslider_failspeedprc(self, event):
        value = int(self.settings_tab_frame_speedfailspeedprcslider.get())
        self.settings_tab_frame_failspeedprcint.delete(0, "end")
        self.settings_tab_frame_failspeedprcint.insert(0, str(value))

        self.config_data['failType']['speed'] = value
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def resetvalue_failspeedprc(self):
        self.settings_tab_frame_failspeedprcint.delete(0, "end")
        self.settings_tab_frame_failspeedprcint.insert(0, "70")
        self.settings_tab_frame_speedfailspeedprcslider.set(70)

        self.config_data['failType']['speed'] = 70
        with open(config_path, 'w') as config_file:
            json.dump(self.config_data, config_file, indent=2)

    def resetspeedvalue(self):
        self.playback_speed = min(500, 100)
        self.speedtext.delete(0, "end")
        self.speedtext.insert(0, 100)
        self.speed.set(100)

    def getPlayHotkey(self):
        self.get_hotkey('play', self.play_hotkey)

    def getPauseHotkey(self):
        self.get_hotkey('pause', self.pause_hotkey)

    def getStopHotkey(self):
        self.get_hotkey('stop', self.stop_hotkey)

    def getSpeedUpHotkey(self):
        self.get_hotkey('speed', self.speed_hotkey)

    def getSlowDownHotkey(self):
        self.get_hotkey('slow', self.slow_hotkey)

    def toggle_playback(self, e=None):
        if not os.path.exists(self.home_frame_entry_1.get()):
            print(f"MIDI File does not exist.")
            threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"MIDI File does not exist.",)).start()
            return

        useMIDI = self.config_data.get('useMIDI', False)
        if not useMIDI and not self.isRunning and not os_name == "Darwin": # Translate
            print("Using MIDI2Qwerty")
            self.selected_device = self.home_frame_combobox_1.get()
            self.midi_file_path = self.home_frame_entry_1.get()
            self.CloseThread = False
            self.play_button.configure(text="Playing", fg_color="#db7b2b")
            self.reset_button.configure(state="normal", fg_color="#cc3232")
            self.isRunning = True
            velocityMap = "1234567890qwertyuiopasdfghjklzxc"
            letterNoteMap = "1!2@34$5%6^78*9(0qQwWeErtTyYuiIoOpPasSdDfgGhHjJklLzZxcCvVbBnm"
            LowNotes = "1234567890qwert"
            HighNotes = "yuiopasdfghj"
            velocityList = [
                0, 4, 8, 12, 16, 20, 24, 28,
                32, 36, 40, 44, 48, 52, 56, 60,
                64, 68, 72, 76, 80, 84, 88, 92,
                96, 100, 104, 108, 112, 116, 120, 124
            ]

            def find_velocity_key(velocity):
                minimum = 0
                maximum = len(velocityList) - 1
                while minimum <= maximum:
                    index = (minimum + maximum) // 2
                    if velocityList[index] == velocity:
                        return velocityMap[index]
                    elif velocityList[index] < velocity:
                        minimum = index + 1
                    else:
                        maximum = index - 1
                return velocityMap[maximum]

            def simulate_key(type, note, velocity):
                if not -15 <= note - 36 <= 88:
                    return
                index = note - 36
                key = 0
                try:
                    key = letterNoteMap[index]
                except:
                    pass

                log_message = None

                if type == "note_on":
                    if self.config_data["velocity"]:
                        velocitykey = find_velocity_key(velocity)
                        self.keyboard_controller.press(Key.alt)
                        self.keyboard_controller.press(velocitykey)
                        self.keyboard_controller.release(velocitykey)
                        self.keyboard_controller.release(Key.alt)
                        log_message = f"velocity: alt + {velocitykey}"

                    if 0 <= note - 36 <= 60:
                        if self.config_data["noDoubles"]:
                            if re.search("[!@$%^*(]", key):
                                self.keyboard_controller.release(letterNoteMap[index - 1])
                            else:
                                self.keyboard_controller.release(key.lower())
                        if re.search("[!@$%^*(]", key):
                            self.keyboard_controller.press(Key.shift)
                            self.keyboard_controller.press(letterNoteMap[index - 1])
                            self.keyboard_controller.release(Key.shift)
                            log_message = f"press: shift + {letterNoteMap[index - 1]}"
                        elif key.isupper():
                            self.keyboard_controller.press(Key.shift)
                            self.keyboard_controller.press(key.lower())
                            self.keyboard_controller.release(Key.shift)
                            log_message = f"press: shift + {key.lower()}"
                        else:
                            self.keyboard_controller.press(key)
                            self.pressed_keys.add(key)
                            log_message = f"press: {key}"
                    elif self.config_data["88Keys"]:
                        K = None
                        if 20 <= note < 40:
                            K = LowNotes[note - 21]
                        else:
                            K = HighNotes[note - 109]
                        if K:
                            self.keyboard_controller.release(K.lower())
                            self.keyboard_controller.press(Key.ctrl)
                            self.keyboard_controller.press(K.lower())
                            self.keyboard_controller.release(Key.ctrl)
                            log_message = f"press: ctrl + {K.lower()}"
                elif 0 <= note - 36 <= 60:
                    if re.search("[!@$%^*(]", key):
                        self.keyboard_controller.release(letterNoteMap[index - 1])
                        log_message = f"release: {letterNoteMap[index - 1]}"
                    else:
                        self.keyboard_controller.release(key.lower())
                        self.pressed_keys.discard(key.lower())
                        log_message = f"release: {key.lower()}"
                else:
                    if 20 <= note < 40:
                        K = LowNotes[note - 21]
                    else:
                        K = HighNotes[note - 109]
                    self.keyboard_controller.release(K.lower())
                    log_message = f"release: {K.lower()}"

                if log_message is not None:
                    if len(self.pressed_keys) > 1:
                        chord_keys = ' + '.join(sorted(self.pressed_keys))
                        print(f"chord: {chord_keys}")
                        if self.config_data.get('console', False):
                            threading.Thread(target=self.consolekl_text_insert, args=(f"chord: {chord_keys}",)).start()
                    else:
                        print(log_message)

                if self.config_data.get('console', False):
                    threading.Thread(target=self.consolekl_text_insert, args=(f"{log_message}",)).start()

            def parse_midi(message):
                if message.type == "control_change" and self.config_data["sustainEnabled"]:
                    if not self.sustainToggle or message.value > self.config_data["sustainCutoff"]:
                        self.sustainToggle = True
                        self.keyboard_controller.press(Key.space)
                        print("press: space (sustain on)")
                    elif self.sustainToggle and message.value < self.config_data["sustainCutoff"]:
                        self.sustainToggle = False
                        self.keyboard_controller.release(Key.space)
                        print("release: space (sustain off)")
                else:
                    if message.type == "note_on" or message.type == "note_off":
                        if message.velocity == 0:
                            try:
                                simulate_key("note_off", message.note, message.velocity)
                            except IndexError:
                                pass
                        else:
                            try:
                                simulate_key(message.type, message.note, message.velocity)
                            except IndexError:
                                pass

            def midi_playback():
                print("nanoMIDI Mid2VK Translator v2.0")
                try:
                    mid = mido.MidiFile(self.midi_file_path)
                    start_time = time.time()
                    current_position = 0
                    total_duration = mid.length

                    for msg in mid:
                        self.pause_event.wait()
                        elapsed_time = time.time() - start_time

                        if self.config_data.get("randomFail"):
                            if random.random() < self.config_data["failType"]["speed"] / 100:
                                playback_speed_factor = random.uniform(0.5, 1.5)
                                time.sleep(msg.time * (100 / self.playback_speed) * playback_speed_factor)
                            elif random.random() < self.config_data["failType"]["transpose"] / 100:
                                if hasattr(msg, 'note'):
                                    msg.note += random.randint(-12, 12)
                                    time.sleep(msg.time * (100 / self.playback_speed))
                            else:
                                time.sleep(msg.time * (100 / self.playback_speed))
                        else:
                            time.sleep(msg.time * (100 / self.playback_speed))

                        parse_midi(msg)

                        if self.CloseThread:
                            break

                        self.CloseThread = False
                        current_time = time.time()
                        elapsed_time = current_time - start_time
                        sleep_time = max(0, msg.time * (100 / self.playback_speed) - elapsed_time)
                        time.sleep(sleep_time)
                        start_time = current_time

                        current_position += msg.time * (100 / self.playback_speed)
                        current_time_str = time.strftime("%H:%M:%S", time.gmtime(current_position)).split(':')
                        current_position_formatted = f"{int(current_time_str[0]) if current_time_str[0] != '00' else '0'}:{int(current_time_str[1]):02d}:{int(current_time_str[2]):02d}"
                        total_duration_str = time.strftime("%H:%M:%S", time.gmtime(total_duration)).split(':')
                        total_duration_formatted = f"{int(total_duration_str[0]) if total_duration_str[0] != '00' else '0'}:{int(total_duration_str[1]):02d}:{int(total_duration_str[2]):02d}"

                        def updatetimeline():
                            if not self.hasUpdated:
                                self.hasUpdated = True
                                self.timeline.configure(text=f"{current_position_formatted} / {total_duration_formatted}")
                                time.sleep(1)
                                self.hasUpdated = False

                        if self.config_data['timestamp'] and not self.hasUpdated:
                            threading.Thread(target=updatetimeline).start()

                    if self.config_data['loopSong'] and not self.CloseThread:
                        midi_playback()
                    else:
                        print("Done")
                        midi_file = MidiFile(self.midi_file_path)
                        self.total_time = midi_file.length
                        self.timelineTextLoadMIDI = f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}" if self.config_data['timestamp'] else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
                        self.timeline.configure(text=self.timelineTextLoadMIDI)
                        self.isRunning = False
                        self.play_button.configure(text="Play", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColorHover"])
                        self.reset_button.configure(state="disabled", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorDisabled"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorHover"])
                        threading.Thread(target=self.consolekl_text_insert, args=(f"----- Done -----",)).start()

                except Exception as e:
                    print("Error: ", e)

            threading.Thread(target=midi_playback, daemon=True).start()

        elif useMIDI:  # Use MIDI
            if not self.isRunning:
                print("Using MIDI Output")
                self.selected_device = self.home_frame_combobox_1.get()
                self.midi_file_path = self.home_frame_entry_1.get()
                if not self.midi_file_path:
                    print("No MIDI File selected")
                    threading.Thread(target=self.consolekl_text_insert_ignorefalse, args=(f"No MIDI File selected",)).start()
                    return

                self.CloseThread = False
                self.play_button.configure(text="Playing", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayingColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayingColorHover"])
                self.reset_button.configure(state="normal", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorHover"])

                self.isRunning = True


                def midi_playback():
                    print("nanoMIDI MIDI Output v2.0")
                    try:
                        mid = mido.MidiFile(self.midi_file_path)
                        start_time = time.time()
                        current_position = 0
                        total_duration = mid.length

                        with mido.open_output(self.selected_device) as output:
                            for msg in mid:
                                self.pause_event.wait()
                                elapsed_time = time.time() - start_time

                                if self.config_data.get("randomFail"):
                                    if random.random() < self.config_data["failType"]["speed"] / 100:
                                        playback_speed_factor = random.uniform(0.5, 1.5)
                                        time.sleep(msg.time * (100 / self.playback_speed) * playback_speed_factor)
                                    elif random.random() < self.config_data["failType"]["transpose"] / 100:
                                        if hasattr(msg, 'note'):
                                            msg.note += random.randint(-12, 12)
                                            time.sleep(msg.time * (100 / self.playback_speed))
                                    else:
                                        time.sleep(msg.time * (100 / self.playback_speed))
                                else:
                                    time.sleep(msg.time * (100 / self.playback_speed))

                                if msg.type in ['note_on', 'note_off', 'control_change']:
                                    output.send(msg)

                                if msg.type in ["note_on"]:
                                    print(f"channel={msg.channel} note={msg.note} velocity={msg.velocity}")
                                    if self.config_data["console"]:
                                        threading.Thread(target=self.consolekl_text_insert, args=(f"chnl={msg.channel} note={msg.note} vlcty={msg.velocity}",)).start()

                                if self.CloseThread:
                                    break

                                current_time = time.time()
                                elapsed_time = current_time - start_time
                                sleep_time = max(0, msg.time * (100 / self.playback_speed) - elapsed_time)
                                time.sleep(sleep_time)
                                start_time = current_time

                                current_position += msg.time * (100 / self.playback_speed)
                                current_time_str = time.strftime("%H:%M:%S", time.gmtime(current_position)).split(':')
                                current_position_formatted = f"{int(current_time_str[0]) if current_time_str[0] != '00' else '0'}:{int(current_time_str[1]):02d}:{int(current_time_str[2]):02d}"
                                total_duration_str = time.strftime("%H:%M:%S", time.gmtime(total_duration)).split(':')
                                total_duration_formatted = f"{int(total_duration_str[0]) if total_duration_str[0] != '00' else '0'}:{int(total_duration_str[1]):02d}:{int(total_duration_str[2]):02d}"

                                def updatetimeline():
                                    if not self.hasUpdated:
                                        self.hasUpdated = True
                                        self.timeline.configure(text=f"{current_position_formatted} / {total_duration_formatted}")
                                        time.sleep(1)
                                        self.hasUpdated = False

                                if self.config_data['timestamp'] and not self.hasUpdated:
                                    threading.Thread(target=updatetimeline).start()

                        if self.config_data['loopSong'] and not self.CloseThread:
                            midi_playback()
                        else:
                            print("Done")
                            midi_file = MidiFile(self.midi_file_path)
                            self.total_time = midi_file.length
                            self.timelineTextLoadMIDI = f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}" if self.config_data['timestamp'] else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
                            self.timeline.configure(text=self.timelineTextLoadMIDI)
                            self.isRunning = False
                            self.play_button.configure(text="Play", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColorHover"])
                            self.reset_button.configure(state="disabled", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorDisabled"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorHover"])
                            threading.Thread(target=self.consolekl_text_insert, args=(f"----- Done -----",)).start()

                    except Exception as e:
                        print("Error: ", e)

                threading.Thread(target=midi_playback, daemon=True).start()

        elif not useMIDI and not self.isRunning and os_name == "Darwin": # macOS MIDI2Qwerty [EXPERIMENTAL]
            print("Using MIDI2Qwerty - MACOS VERSION [EXPERIMENTAL]")
            self.selected_device = self.home_frame_combobox_1.get()
            self.midi_file_path = self.home_frame_entry_1.get()
            if not self.midi_file_path:
                print("No MIDI File selected")
                threading.Thread(target=self.consolekl_text_insert_ignorefalse,
                                 args=(f"No MIDI File selected",)).start()
                return
            self.CloseThread = False
            self.play_button.configure(text="Playing", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayingColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayingColorHover"])
            self.reset_button.configure(state="normal", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColor"],hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorHover"])
            self.isRunning = True

            velocityMap = "1234567890qwertyuiopasdfghjklzxc"
            letterNoteMap = "1!2@34$5%6^78*9(0qQwWeErtTyYuiIoOpPasSdDfgGhHjJklLzZxcCvVbBnm"
            LowNotes = "1234567890qwert"
            HighNotes = "yuiopasdfghj"
            velocityList = [
                0, 4, 8, 12, 16, 20, 24, 28,
                32, 36, 40, 44, 48, 52, 56, 60,
                64, 68, 72, 76, 80, 84, 88, 92,
                96, 100, 104, 108, 112, 116, 120, 124
            ]

            def find_velocity_key(velocity):
                minimum = 0
                maximum = len(velocityList) - 1
                while minimum <= maximum:
                    index = (minimum + maximum) // 2
                    if velocityList[index] == velocity:
                        return velocityMap[index]
                    elif velocityList[index] < velocity:
                        minimum = index + 1
                    else:
                        maximum = index - 1
                return velocityMap[maximum]

            def handle_keyboard_events():
                while True:
                    event = self.keyboard_queue.get()
                    if event is None:
                        break
                    key, action = event
                    if action == 'press':
                        kb.press(key)
                    elif action == 'release':
                        kb.release(key)
                    self.keyboard_queue.task_done()

            def simulate_key(type, note, velocity):
                if not -15 <= note - 36 <= 88:
                    return
                index = note - 36
                key = 0
                try:
                    key = letterNoteMap[index]
                except:
                    pass

                log_message = None

                if type == "note_on":
                    if self.config_data["velocity"]:
                        velocitykey = find_velocity_key(velocity)
                        self.keyboard_controller.press(Key.alt)
                        self.keyboard_controller.press(velocitykey)
                        self.keyboard_controller.release(velocitykey)
                        self.keyboard_controller.release(Key.alt)
                        log_message = f"velocity: alt + {velocitykey}"

                    if 0 <= note - 36 <= 60:
                        if self.config_data["noDoubles"]:
                            if re.search("[!@$%^*(]", key):
                                self.keyboard_controller.release(letterNoteMap[index - 1])
                            else:
                                self.keyboard_controller.release(key.lower())
                        if re.search("[!@$%^*(]", key):
                            self.keyboard_controller.press(Key.shift)
                            self.keyboard_queue.put((key.lower(), 'press'))
                            log_message = f"press: shift + {key.lower()} (using both modules)"
                        elif key.isupper():
                            self.keyboard_controller.press(Key.shift)
                            self.keyboard_controller.press(key.lower())
                            self.keyboard_controller.release(Key.shift)
                            log_message = f"press: shift + {key.lower()}"
                        else:
                            if key.isdigit():
                                self.keyboard_queue.put((key, 'press'))
                                log_message = f"press: {key} (using keyboard module)"
                            else:
                                self.keyboard_controller.press(key)
                                log_message = f"press: {key}"
                    elif self.config_data["88Keys"]:
                        K = None
                        if 20 <= note < 40:
                            K = LowNotes[note - 21]
                        else:
                            K = HighNotes[note - 109]
                        if K:
                            self.keyboard_controller.release(K.lower())
                            self.keyboard_controller.press(Key.ctrl)
                            self.keyboard_controller.press(K.lower())
                            self.keyboard_controller.release(Key.ctrl)
                            log_message = f"press: ctrl + {K.lower()}"
                elif 0 <= note - 36 <= 60:
                    if re.search("[!@$%^*(]", key):
                        self.keyboard_queue.put((key.lower(), 'release'))
                        self.keyboard_controller.release(Key.shift)
                        log_message = f"release: shift + {key.lower()} (using both modules)"
                    else:
                        if key.isdigit():
                            self.keyboard_queue.put((key, 'release'))
                            log_message = f"release: {key} (using keyboard module)"
                        else:
                            self.keyboard_controller.release(key.lower())
                            log_message = f"release: {key.lower()}"
                else:
                    if 20 <= note < 40:
                        K = LowNotes[note - 21]
                    else:
                        K = HighNotes[note - 109]
                    self.keyboard_controller.release(K.lower())
                    log_message = f"release: {K.lower()}"

                if log_message is not None:
                    if len(self.pressed_keys) > 1:
                        chord_keys = ' + '.join(sorted(self.pressed_keys))
                        print(f"chord: {chord_keys}")
                        if self.config_data.get('console', False):
                            threading.Thread(target=self.consolekl_text_insert, args=(f"chord: {chord_keys}",)).start()
                    else:
                        print(log_message)

                if self.config_data.get('console', False):
                    threading.Thread(target=self.consolekl_text_insert, args=(f"{log_message}",)).start()

            def parse_midi(message):
                if message.type == "control_change" and self.config_data["sustainEnabled"]:
                    if not self.sustainToggle or message.value > self.config_data["sustainCutoff"]:
                        self.sustainToggle = True
                        self.keyboard_controller.press(Key.space)
                        print("press: space (sustain on)")
                    elif self.sustainToggle and message.value < self.config_data["sustainCutoff"]:
                        self.sustainToggle = False
                        self.keyboard_controller.release(Key.space)
                        print("release: space (sustain off)")
                else:
                    if message.type == "note_on" or message.type == "note_off":
                        if message.velocity == 0:
                            try:
                                simulate_key("note_off", message.note, message.velocity)
                            except IndexError:
                                pass
                        else:
                            try:
                                simulate_key(message.type, message.note, message.velocity)
                            except IndexError:
                                pass

            def midi_playback():
                print("nanoMIDI Mid2VK Translator v2.0")
                try:
                    mid = mido.MidiFile(self.midi_file_path)
                    start_time = time.time()
                    current_position = 0
                    total_duration = mid.length

                    keyboard_thread = threading.Thread(target=handle_keyboard_events, daemon=True)
                    keyboard_thread.start()

                    for msg in mid:
                        self.pause_event.wait()
                        elapsed_time = time.time() - start_time

                        if self.config_data.get("randomFail"):
                            if random.random() < self.config_data["failType"]["speed"] / 100:
                                playback_speed_factor = random.uniform(0.5, 1.5)
                                time.sleep(msg.time * (100 / self.playback_speed) * playback_speed_factor)
                            elif random.random() < self.config_data["failType"]["transpose"] / 100:
                                if hasattr(msg, 'note'):
                                    msg.note += random.randint(-12, 12)
                                    time.sleep(msg.time * (100 / self.playback_speed))
                            else:
                                time.sleep(msg.time * (100 / self.playback_speed))
                        else:
                            time.sleep(msg.time * (100 / self.playback_speed))

                        parse_midi(msg)

                        if self.CloseThread:
                            break

                        self.CloseThread = False
                        current_time = time.time()
                        elapsed_time = current_time - start_time
                        sleep_time = max(0, msg.time * (100 / self.playback_speed) - elapsed_time)
                        time.sleep(sleep_time)
                        start_time = current_time

                        current_position += msg.time * (100 / self.playback_speed)
                        current_time_str = time.strftime("%H:%M:%S", time.gmtime(current_position)).split(':')
                        current_position_formatted = f"{int(current_time_str[0]) if current_time_str[0] != '00' else '0'}:{int(current_time_str[1]):02d}:{int(current_time_str[2]):02d}"
                        total_duration_str = time.strftime("%H:%M:%S", time.gmtime(total_duration)).split(':')
                        total_duration_formatted = f"{int(total_duration_str[0]) if total_duration_str[0] != '00' else '0'}:{int(total_duration_str[1]):02d}:{int(total_duration_str[2]):02d}"

                        def updatetimeline():
                            if not self.hasUpdated:
                                self.hasUpdated = True
                                self.timeline.configure(
                                    text=f"{current_position_formatted} / {total_duration_formatted}")
                                time.sleep(1)
                                self.hasUpdated = False

                        if self.config_data['timestamp'] and not self.hasUpdated:
                            threading.Thread(target=updatetimeline).start()

                    if self.config_data['loopSong'] and not self.CloseThread:
                        midi_playback()
                    else:
                        print("Done")
                        midi_file = MidiFile(self.midi_file_path)
                        self.total_time = midi_file.length
                        self.timelineTextLoadMIDI = f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}" if self.config_data['timestamp'] else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
                        self.timeline.configure(text=self.timelineTextLoadMIDI)
                        self.isRunning = False
                        self.play_button.configure(text="Play", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayColorHover"])
                        self.reset_button.configure(state="disabled", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorDisabled"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["StopColorHover"])
                        threading.Thread(target=self.consolekl_text_insert, args=(f"----- Done -----",)).start()

                except Exception as e:
                    print("Error: ", e)
                finally:
                    self.keyboard_queue.put(None)
                    keyboard_thread.join()

            threading.Thread(target=midi_playback, daemon=True).start()

    def pause_playback(self, event=None):
        if self.isRunning:
            if self.pause_event.is_set():
                self.pause_event.clear()
                print("Paused")
                self.play_button.configure(text="Paused", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PausedColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PausedColorHover"])
                threading.Thread(target=self.consolekl_text_insert, args=(f"----- Paused -----",)).start()
            else:
                self.pause_event.set()
                print("Resumed")
                self.play_button.configure(text="Playing", fg_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayingColor"], hover_color=self.activeThemeData["Theme"]["MidiPlayer"]["PlayingColor"])
                threading.Thread(target=self.consolekl_text_insert, args=(f"----- Resumed -----",)).start()

    def stop_playback(self, event=None):
        if self.isRunning:
            self.pause_event.set()
            self.CloseThread = True
            for key in self.pressed_keys:
                self.keyboard_controller.release(key)
            self.pressed_keys.clear()

    def speedup_playback(self, event=None):
        self.playback_speed = max(10, self.playback_speed - self.config_data['decreaseSize'])
        self.speed.set(self.playback_speed)

        rounded_value = round(float(self.playback_speed))
        self.speedtext.delete(0, "end")
        self.speedtext.insert(0, str(rounded_value))

        print(f"speed: {self.playback_speed}")

    def slowdown_playback(self, event=None):
        self.playback_speed = min(500, self.playback_speed + self.config_data['decreaseSize'])
        self.speed.set(self.playback_speed)

        rounded_value = round(float(self.playback_speed))
        self.speedtext.delete(0, "end")
        self.speedtext.insert(0, str(rounded_value))

        print(f"speed: {self.playback_speed}")

    def consolekl_text_insert(self, text):
        if self.config_data.get('console', False):
            label = tk.Label(self.consolekl, text=text, fg=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], bg=self.activeThemeData["Theme"]["MidiPlayer"]["ConsoleBackground"], height=1, font=self.global_font12)
            label.pack(anchor="sw")
            self.log_labels.append(label)

            if len(self.log_labels) > self.max_log_messages:
                oldest_label = self.log_labels.pop(0)
                oldest_label.destroy()

            if len(self.consolekl.winfo_children()) > 20:
                for widget in self.consolekl.winfo_children():
                    widget.destroy()

            self.consolekl.update_idletasks()

    def consolekl_text_insert_ignorefalse(self, text):
        label = tk.Label(self.consolekl, text=text, fg=self.activeThemeData["Theme"]["MidiPlayer"]["TextColor"], bg=self.activeThemeData["Theme"]["MidiPlayer"]["ConsoleBackground"], height=1, font=self.global_font12)
        label.pack(anchor="sw")
        self.log_labels.append(label)

        if len(self.log_labels) > self.max_log_messages:
            oldest_label = self.log_labels.pop(0)
            oldest_label.destroy()

        if len(self.consolekl.winfo_children()) > 20:
            for widget in self.consolekl.winfo_children():
                widget.destroy()

        self.consolekl.update_idletasks()

    def update_timeline(self):
        if self.playback_start_time is not None and self.playback_state:
            elapsed_time = time.time() - self.playback_start_time
            total_time = self.midi_file.length
            elapsed_time_str = str(datetime.timedelta(seconds=int(elapsed_time)))
            total_time_str = str(datetime.timedelta(seconds=int(total_time)))
            timeline_text = f"{elapsed_time_str} / {total_time_str}"
            self.timeline.configure(text=timeline_text)
            self.after(1000, self.update_timeline)

    def open_file_dialog(self):
        self.home_frame_entry_1.set("")
        self.stop_playback_flag.set()
        self.playback_state = False
        self.play_button.configure(text="Play")
        self.CloseThread = True

        self.ignore_key_press = True
        self.stop_playback()

        file_path = filedialog.askopenfilename(filetypes=[("MIDI files", "*.mid"), ("MIDI files", "*.midi")])
        if file_path:
            currentVAL = list(self.home_frame_entry_1.cget("values"))
            if file_path not in currentVAL:
                currentVAL.append(file_path)
                self.home_frame_entry_1.configure(values=currentVAL)

            self.home_frame_entry_1.set(file_path)

            midi_file = MidiFile(file_path)
            self.total_time = midi_file.length
            self.timelineTextLoadMIDI = (
                f"0:00:00 / {str(datetime.timedelta(seconds=int(self.total_time)))}"
                if self.config_data['timestamp']
                else f"X:XX:XX / {str(datetime.timedelta(seconds=int(self.total_time)))}"
            )
            self.timeline.configure(text=self.timelineTextLoadMIDI)

            self.config_data['midiFile'] = file_path
            if 'addedMIDI' not in self.config_data:
                self.config_data['addedMIDI'] = []
            if file_path not in self.config_data['addedMIDI']:
                self.config_data['addedMIDI'].append(file_path)

            with open(config_path, 'w') as config_file:
                json.dump(self.config_data, config_file, indent=2)

            self.ignore_key_press = False

    def select_frame_by_name(self, name):
        self.home_button.configure(fg_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonSelectedColor"] if name == "home" else self.activeThemeData["Theme"]["Navigation"]["TabButtonColor"])
        if name == "home":
            self.home_frame.grid(row=0, column=1, sticky="nsew")
        else:
            self.home_frame.grid_forget()

        self.midi_hub.configure(fg_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonSelectedColor"] if name == "midi_hub" else self.activeThemeData["Theme"]["Navigation"]["TabButtonColor"])
        if name == "midi_hub":
            self.midi_hub_frame.grid(row=0, column=1, sticky="nsew")
        else:
            self.midi_hub_frame.grid_forget()
            for widget in self.midi_hub_frame.winfo_children():
                if widget != self.midi_hub_searchbar and \
                (not hasattr(self, 'search_button') or widget != self.search_button) and \
                (not hasattr(self, 'sort_combo') or widget != self.sort_combo):
                    widget.destroy()

            please_wait = customtkinter.CTkLabel(
                self.midi_hub_frame, text="Please Wait...", text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
                compound="left", font=self.global_font40
            )
            please_wait.grid(row=1, column=0, padx=10, pady=(150,0), sticky="nsew")
            please_wait2 = customtkinter.CTkLabel(
                self.midi_hub_frame, text="Fetching from nanomidi.net...", text_color=self.activeThemeData["Theme"]["MIDIHub"]["TextColor"],
                compound="left", font=self.global_font
            )
            please_wait2.grid(row=2, column=0, padx=10, pady=(150,0), sticky="nsew")

        self.settings_tab.configure(fg_color=self.activeThemeData["Theme"]["Navigation"]["TabButtonSelectedColor"] if name == "settings_tab" else self.activeThemeData["Theme"]["Navigation"]["TabButtonColor"])
        if name == "settings_tab":
            self.settings_tab_frame.grid(row=0, column=1, sticky="nsew")
        else:
            self.settings_tab_frame.grid_forget()

        if name == "permission_tab":
            self.permission_tab_frame.grid(row=0, column=1, sticky="nsew")
        else:
            self.permission_tab_frame.grid_forget()

    def home_button_event(self):
        self.select_frame_by_name("home")

    def midi_hub_event(self):
        self.select_frame_by_name("midi_hub")
        threading.Thread(target=self.load_midi_data).start()

    def settings_tab_event(self):
        self.select_frame_by_name("settings_tab")

    def permission_tab_event(self):
        self.select_frame_by_name("permission_tab")

    def create_debug_console(self):
        ctypes.windll.kernel32.AllocConsole()
        sys.stdout = open('CONOUT$', 'w')
        sys.stderr = open('CONOUT$', 'w')
        sys.stdin = open('CONIN$', 'r')
        print("created output.")

    def close_debug_console(self):
        ctypes.windll.kernel32.FreeConsole()

        sys.stdout.close()
        sys.stderr.close()
        sys.stdin.close()

        sys.stdout = sys.__stdout__
        sys.stderr = sys.__stderr__
        sys.stdin = sys.__stdin__

        print("closed output.")

    def fetchThemes(self):
        try:
            response = requests.get("https://api.nanomidi.net/api/nanomidiplayer/theme")
            response.raise_for_status()
            data = response.json()
            
            theme_names = list(data["availableThemes"].keys())
            return theme_names
        except requests.RequestException as e:
            print(e)
            return []
        
    def CreateToolTip(self, widget, text):
        if not os_name == "Darwin":
            toolTip = ToolTip(widget)
            def enter(event):
                toolTip.showtip(text)
            def leave(event):
                toolTip.hidetip()
            widget.bind('<Enter>', enter)
            widget.bind('<Leave>', leave)

if __name__ == "__main__":
    loading = LoadingScreen()
    loading.mainloop()